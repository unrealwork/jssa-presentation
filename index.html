<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y"
    crossorigin="anonymous">
  <link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/texmath.css">
  <link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/vscode-texmath.css">

</head>
<style>
  .markdown-body {
		box-sizing: border-box;
		min-width: 200px;
		max-width: 1400px;
		margin: 0 auto;
		padding: 45px;
	}

	@media (max-width: 767px) {
		.markdown-body {
			padding: 15px;
		}
	}
</style>
<body class="markdown-body">
  <h1 id="singular-spectrum-analysis-with-java-1" data-line="0" class="code-line">Singular Spectrum Analysis with Java</h1>
  <h2 id="table-of-contents-1" data-line="2" class="code-line">Table of contents</h2>
  <ul>
    <li data-line="3" class="code-line"><a href="#singular-spectrum-analysis-implementation-in-java">Singular Spectrum
        Analysis Implementation in Java</a>
      <ul>
        <li data-line="4" class="code-line"><a href="#introduction">Introduction</a></li>
        <li data-line="5" class="code-line"><a href="#main-algorithm-recap">Main algorithm recap</a>
          <ul>
            <li data-line="6" class="code-line"><a href="#basic-ssa">Basic SSA</a>
              <ul>
                <li data-line="7" class="code-line"><a href="#main-algorithm-of-ssa">Main algorithm of SSA</a></li>
                <li data-line="8" class="code-line"><a href="#1st-step-embedding">1st step: Embedding</a></li>
                <li data-line="9" class="code-line"><a href="#2nd-step-singular-value-decomposition">2nd step: Singular
                    Value Decomposition</a></li>
                <li data-line="10" class="code-line"><a href="#3rd-step-eigentriple-grouping">3rd step: Eigentriple
                    grouping</a></li>
                <li data-line="11" class="code-line"><a href="#4th-step-diagonal-averaging">4th step: Diagonal
                    averaging</a></li>
              </ul>
            </li>
            <li data-line="12" class="code-line"><a href="#forecasting-by-ssa">Forecasting by SSA</a></li>
            <li data-line="13" class="code-line"><a href="#using-libraries">Using libraries</a>
              <ul>
                <li data-line="14" class="code-line"><a href="#smile">Smile</a>
                  <ul>
                    <li data-line="15" class="code-line"><a href="#using-for-in-the-package">Using for in the package</a></li>
                  </ul>
                </li>
                <li data-line="16" class="code-line"><a href="#lapack">Lapack</a>
                  <ul>
                    <li data-line="17" class="code-line"><a href="#using-for-in-the-package-1">Using for in the package</a></li>
                  </ul>
                </li>
                <li data-line="18" class="code-line"><a href="#apache-commons-math">Apache commons-math</a>
                  <ul>
                    <li data-line="19" class="code-line"><a href="#using-for-in-the-package-2">Using for in the package</a></li>
                  </ul>
                </li>
                <li data-line="20" class="code-line"><a href="#jtransoforms">JTransoforms</a><a href="#using-for-in-the-package-3">Using
                    for in the package</a></li>
              </ul>
            </li>
            <li data-line="21" class="code-line"><a href="#implementation">Implementation</a>
              <ul>
                <li data-line="22" class="code-line"><a href="#embedding">Embedding</a></li>
                <li data-line="23" class="code-line"><a href="#singular-value-decomposition">Singular Value
                    Decomposition</a>
                  <ul>
                    <li data-line="24" class="code-line"><a href="#matrix-vector-multiplication-for-ssa-trajectory-matrix">Matrix-Vector
                        Multiplication for SSA Trajectory Matrix</a></li>
                    <li data-line="25" class="code-line"><a href="#matrix-vector-multiplication-for-transpose-of-ssa-trajectory-matrix">Matrix-Vector
                        Multiplication for transpose of SSA Trajectory Matrix</a></li>
                    <li data-line="26" class="code-line"><a href="#decomposition-code">Decomposition code</a></li>
                    <li data-line="27" class="code-line"><a href="#reconstructionhankelization">Reconstruction(hankelization)</a></li>
                  </ul>
                </li>
                <li data-line="28" class="code-line"><a href="#grouping">Grouping</a>
                  <ul>
                    <li data-line="29" class="code-line"><a href="#form-proximity-matrix">Form proximity matrix</a></li>
                    <li data-line="30" class="code-line"><a href="#clustering-of-the-reconstrcted-series">Clustering of
                        the reconstrcted series</a></li>
                  </ul>
                </li>
                <li data-line="31" class="code-line"><a href="#forecasting">Forecasting</a>
                  <ul>
                    <li data-line="32" class="code-line"><a href="#estimation-of-the-signal-lrr">Estimation of the
                        signal LRR</a></li>
                    <li data-line="33" class="code-line"><a href="#usages">Usages</a></li>
                    <li data-line="34" class="code-line"><a href="#sample">Sample</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li data-line="35" class="code-line"><a href="#benchmarks">Benchmarks</a>
      <ul>
        <li data-line="36" class="code-line"><a href="#difference-between-native-approach-and-fast-multiplication-version">Difference
            between native approach and fast-multiplication version</a></li>
      </ul>
    </li>
  </ul>
  <h2 id="introduction-1" data-line="38" class="code-line">Introduction</h2>
  <p data-line="40" class="code-line">In time series analysis, <strong>singular spectrum analysis</strong> (<code>SSA</code>)
    is a nonparametric spectral estimation method.</p>
  <p data-line="42" class="code-line">SSA can be used as a model-free technique hence that it can be applied to
    arbitrary time series including non-stationary time series. The basic aim of SSA is to decompose the time series
    into the sum of interpretable components such as trend, periodic components and noise with no a-priori assumptions
    about the parametric form of these components.</p>
  <h3 id="main-algorithm-recap-1" data-line="44" class="code-line">Main algorithm recap</h3>
  <p data-line="46" class="code-line"><img src="/Users/igor.shmagrinskiy/Development/git/axibasessa/docs/images/ssa-scheme.jpg"
      alt="SSA Scheme" class="loading" id="image-hash-87c61a987c0deba39805ebfd555c6bedaf34703e559ad2376206cde99bd5b2a8"></p>
  <h4 id="basic-ssa-1" data-line="48" class="code-line">Basic SSA</h4>
  <p data-line="50" class="code-line">Consider a real-valued time series <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="double-struck">X</mi>
              <mo>=</mo>
              <mo>(</mo>
              <msub>
                <mi>x</mi>
                <mn>1</mn>
              </msub>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <msub>
                <mi>x</mi>
                <mi>N</mi>
              </msub>
              <mo>)</mo>
            </mrow>
            <annotation encoding="application/x-tex">\mathbb{X}=(x_1,\ldots,x_{N})</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbb">X</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span
            class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">x</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                            style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mclose">)</span></span></span></span> of length <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>N</mi>
              </mrow>
              <annotation encoding="application/x-tex">N</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></eq>. Let <eq><span
        class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>L</mi>
              </mrow>
              <annotation encoding="application/x-tex">L</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault">L</span></span></span></span></eq> <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mtext> </mtext>
              <mo>(</mo>
              <mn>1</mn>
              <mo>&lt;</mo>
              <mi>L</mi>
              <mo>&lt;</mo>
              <mi>N</mi>
              <mo>)</mo>
            </mrow>
            <annotation encoding="application/x-tex">\ (1&lt;L &lt; N)</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mspace"> </span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathit">L</span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>
    be some integer called the ''window length'' and <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>K</mi>
              <mo>=</mo>
              <mi>N</mi>
              <mo>−</mo>
              <mi>L</mi>
              <mo>+</mo>
              <mn>1</mn>
            </mrow>
            <annotation encoding="application/x-tex">K=N-L+1</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
            class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathit"
            style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
          class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathit">L</span><span
            class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
            class="mord">1</span></span></span></span>.</p>
  <h4 id="main-algorithm-of-ssa-1" data-line="52" class="code-line">Main algorithm of SSA</h4>
  <h5 id="1st-step-embedding-1" data-line="54" class="code-line">1st step: Embedding</h5>
  <p data-line="56" class="code-line">Form the <strong>trajectory matrix</strong> of the series <span class="katex"><span
        class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="double-struck">X</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathbb{X}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbb">X</span></span></span></span></span>, which is the <span class="katex"><span
        class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>L</mi>
              <mtext>&NegativeThinSpace;</mtext>
              <mo>×</mo>
              <mtext>&NegativeThinSpace;</mtext>
              <mi>K</mi>
            </mrow>
            <annotation encoding="application/x-tex">L\!\times\! K</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span
            class="mord mathit">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span
            class="mspace" style="margin-right:-0.16666666666666666em;"></span><span class="mbin">×</span><span class="mspace"
            style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:-0.16666666666666666em;"></span></span><span
          class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit"
            style="margin-right:0.07153em;">K</span></span></span></span> matrix</p>
  <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi mathvariant="bold">X</mi>
                <mo>=</mo>
                <mo>[</mo>
                <msub>
                  <mi>X</mi>
                  <mn>1</mn>
                </msub>
                <mo>:</mo>
                <mo>…</mo>
                <mo>:</mo>
                <msub>
                  <mi>X</mi>
                  <mi>K</mi>
                </msub>
                <mo>]</mo>
                <mo>=</mo>
                <mo>(</mo>
                <msub>
                  <mi>x</mi>
                  <mrow>
                    <mi>i</mi>
                    <mi>j</mi>
                  </mrow>
                </msub>
                <msubsup>
                  <mo>)</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo separator="true">,</mo>
                    <mi>j</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow>
                    <mi>L</mi>
                    <mo separator="true">,</mo>
                    <mi>K</mi>
                  </mrow>
                </msubsup>
                <mo>=</mo>
                <mrow>
                  <mo fence="true">[</mo>
                  <mtable>
                    <mtr>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mn>1</mn>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mn>2</mn>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mn>3</mn>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <mo>…</mo>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mi>K</mi>
                          </msub>
                        </mstyle>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mn>2</mn>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mn>3</mn>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mn>4</mn>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <mo>…</mo>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mrow>
                              <mi>K</mi>
                              <mo>+</mo>
                              <mn>1</mn>
                            </mrow>
                          </msub>
                        </mstyle>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mn>3</mn>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mn>4</mn>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mn>5</mn>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <mo>…</mo>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mrow>
                              <mi>K</mi>
                              <mo>+</mo>
                              <mn>2</mn>
                            </mrow>
                          </msub>
                        </mstyle>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <mi mathvariant="normal">⋮</mi>
                          <mrow></mrow>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <mi mathvariant="normal">⋮</mi>
                          <mrow></mrow>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <mi mathvariant="normal">⋮</mi>
                          <mrow></mrow>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <mo>⋱</mo>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <mi mathvariant="normal">⋮</mi>
                          <mrow></mrow>
                        </mstyle>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mi>L</mi>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mrow>
                              <mi>L</mi>
                              <mo>+</mo>
                              <mn>1</mn>
                            </mrow>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mrow>
                              <mi>L</mi>
                              <mo>+</mo>
                              <mn>2</mn>
                            </mrow>
                          </msub>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <mo>…</mo>
                        </mstyle>
                      </mtd>
                      <mtd>
                        <mstyle scriptlevel="0" displaystyle="false">
                          <msub>
                            <mi>x</mi>
                            <mi>N</mi>
                          </msub>
                        </mstyle>
                      </mtd>
                    </mtr>
                  </mtable>
                  <mo fence="true">]</mo>
                </mrow>
              </mrow>
              <annotation encoding="application/x-tex">
                \mathbf{X}=[X_1:\ldots:X_K]=(x_{ij})_{i,j=1}^{L,K}=
                \begin{bmatrix}
                x_1&amp;x_2&amp;x_3&amp;\ldots&amp;x_{K}\\
                x_2&amp;x_3&amp;x_4&amp;\ldots&amp;x_{K+1}\\
                x_3&amp;x_4&amp;x_5&amp;\ldots&amp;x_{K+2}\\
                \vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
                x_{L}&amp;x_{L+1}&amp;x_{L+2}&amp;\ldots&amp;x_{N}\\
                \end{bmatrix}
              </annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
              class="mord"><span class="mord mathbf">X</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span
              class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
              class="minner">…</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight"
                            style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:1.372211em;vertical-align:-0.412972em;"></span><span class="mopen">(</span><span class="mord"><span
                class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                      class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight"
                              style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span
              class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.959239em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span
                              class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span
                              class="mord mtight">1</span></span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight">L</span><span class="mpunct mtight">,</span><span
                              class="mord mathit mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:6.66em;vertical-align:-3.08em;"></span><span
              class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:3.554995em;"><span style="top:-0.7499750000000004em;"><span
                            class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span
                          style="top:-1.9049750000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span
                            class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-2.5059750000000003em;"><span
                            class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span
                          style="top:-3.1069750000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span
                            class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.7079750000000002em;"><span
                            class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span
                          style="top:-4.308975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span
                            class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-5.554995em;"><span
                            class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em;"><span></span></span></span></span></span></span><span
                class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                          class="vlist" style="height:3.5800000000000005em;"><span style="top:-6.427500000000001em;"><span
                              class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span
                                  class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span
                                      class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span
                                      class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-4.0275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span
                                      class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-2.1675000000000004em;"><span class="pstrut" style="height:3.6875em;"></span><span
                              class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span
                            style="top:-0.9675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight"><span class="mord mathit mtight">L</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.08em;"><span></span></span></span></span></span><span
                    class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span
                    class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span
                            style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span
                              class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span
                                      class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span
                                      class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-4.0275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span
                                      class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-2.1675000000000004em;"><span class="pstrut" style="height:3.6875em;"></span><span
                              class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span
                            style="top:-0.9675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight"><span class="mord mathit mtight">L</span><span class="mbin mtight">+</span><span
                                                class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span
                                      class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.08em;"><span></span></span></span></span></span><span
                    class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span
                    class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span
                            style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span
                              class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span
                                      class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span
                                      class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-4.0275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span
                                      class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-2.1675000000000004em;"><span class="pstrut" style="height:3.6875em;"></span><span
                              class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span
                            style="top:-0.9675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight"><span class="mord mathit mtight">L</span><span class="mbin mtight">+</span><span
                                                class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span
                                      class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.08em;"><span></span></span></span></span></span><span
                    class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span
                    class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span
                            style="top:-6.240000000000001em;"><span class="pstrut" style="height:3.5em;"></span><span
                              class="mord"><span class="minner">…</span></span></span><span style="top:-5.04em;"><span
                              class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span><span
                            style="top:-3.84em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span
                                class="minner">…</span></span></span><span style="top:-1.9800000000000006em;"><span
                              class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span
                            style="top:-0.78em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span
                                class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist" style="height:3.08em;"><span></span></span></span></span></span><span
                    class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span
                    class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5800000000000005em;"><span
                            style="top:-6.427500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span
                              class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.07153em;">K</span><span
                                                class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-4.0275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.07153em;">K</span><span
                                                class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span><span
                            style="top:-2.1675000000000004em;"><span class="pstrut" style="height:3.6875em;"></span><span
                              class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span
                            style="top:-0.9675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                      class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                              class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.08em;"><span></span></span></span></span></span></span></span><span
                class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                        class="vlist" style="height:3.554995em;"><span style="top:-0.7499750000000004em;"><span class="pstrut"
                            style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span
                          style="top:-1.9049750000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span
                            class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-2.5059750000000003em;"><span
                            class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span
                          style="top:-3.1069750000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span
                            class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.7079750000000002em;"><span
                            class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span
                          style="top:-4.308975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span
                            class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-5.554995em;"><span
                            class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
  <p data-line="69" class="code-line">where</p>
  <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msub>
                  <mi>X</mi>
                  <mi>i</mi>
                </msub>
                <mo>=</mo>
                <mo>(</mo>
                <msub>
                  <mi>x</mi>
                  <mi>i</mi>
                </msub>
                <mo separator="true">,</mo>
                <mo>…</mo>
                <mo separator="true">,</mo>
                <msub>
                  <mi>x</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>+</mo>
                    <mi>L</mi>
                    <mo>−</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <msup>
                  <mo>)</mo>
                  <mi mathvariant="normal">T</mi>
                </msup>
                <mtext>&ThickSpace;</mtext>
                <mspace width="1em" />
                <mo>(</mo>
                <mn>1</mn>
                <mo>≤</mo>
                <mi>i</mi>
                <mo>≤</mo>
                <mi>K</mi>
                <mo>)</mo>
              </mrow>
              <annotation encoding="application/x-tex">
                X_i=(x_{i},\ldots,x_{i+L-1})^\mathrm{T} \; \quad (1\leq i\leq K)
              </annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
              class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span
              class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span
                              class="mord mathit mtight">L</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span
              class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span><span
              class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:0.79549em;vertical-align:-0.13597em;"></span><span class="mord mathit">i</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mclose">)</span></span></span></span></span></p>
  <p data-line="75" class="code-line">are <strong>lagged vectors</strong> of size <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>L</mi>
              </mrow>
              <annotation encoding="application/x-tex">L</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault">L</span></span></span></span></eq>. The matrix <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="bold">X</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbf">X</span></span></span></span></span> is a <strong>Hankel matrix</strong>
    which means that <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="bold">X</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbf">X</span></span></span></span></span> has equal elements <span class="katex"><span
        class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mi>i</mi>
                  <mi>j</mi>
                </mrow>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">x_{ij}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span
            class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight"
                            style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>
    on the anti-diagonals <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>i</mi>
              <mo>+</mo>
              <mi>j</mi>
              <mo>=</mo>
              <mtext>&ThinSpace;</mtext>
              <mrow>
                <mi mathvariant="normal">c</mi>
                <mi mathvariant="normal">o</mi>
                <mi mathvariant="normal">n</mi>
                <mi mathvariant="normal">s</mi>
                <mi mathvariant="normal">t</mi>
              </mrow>
            </mrow>
            <annotation encoding="application/x-tex">i+j =\,{\rm const}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span
            class="mord mathit">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span
            class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
          class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathit"
            style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span
            class="mord"><span class="mord"><span class="mord mathrm">c</span><span class="mord mathrm">o</span><span
                class="mord mathrm">n</span><span class="mord mathrm">s</span><span class="mord mathrm">t</span></span></span></span></span></span>.</p>
  <h5 id="2nd-step-singular-value-decomposition-1" data-line="77" class="code-line">2nd step: Singular Value
    Decomposition</h5>
  <p data-line="79" class="code-line">Perform the singular value decomposition (SVD) of the trajectory matrix <span
      class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="bold">X</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbf">X</span></span></span></span></span>. Set <span class="katex"><span
        class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="bold">S</mi>
              <mo>=</mo>
              <mi mathvariant="bold">X</mi>
              <msup>
                <mi mathvariant="bold">X</mi>
                <mi mathvariant="normal">T</mi>
              </msup>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{S}=\mathbf{X} \mathbf{X}^\mathrm{T}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbf">S</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span
              class="mord mathbf">X</span></span><span class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span
              class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span
                      style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span></span></span></span>
    and denote by <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>λ</mi>
                <mn>1</mn>
              </msub>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <msub>
                <mi>λ</mi>
                <mi>L</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">\lambda_1, \ldots,\lambda_L</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
            class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">L</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    the <strong>eigenvalues</strong> of <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="bold">S</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{S}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbf">S</span></span></span></span></span> taken in the decreasing order
    of magnitude (<span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>λ</mi>
                <mn>1</mn>
              </msub>
              <mo>≥</mo>
              <mo>…</mo>
              <mo>≥</mo>
              <msub>
                <mi>λ</mi>
                <mi>L</mi>
              </msub>
              <mo>≥</mo>
              <mn>0</mn>
            </mrow>
            <annotation encoding="application/x-tex">\lambda_1\geq \ldots \geq \lambda_L\geq 0</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span
            class="minner">…</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
            style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit">λ</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">L</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
            class="mord">0</span></span></span></span>) and by <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>U</mi>
                <mn>1</mn>
              </msub>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <msub>
                <mi>U</mi>
                <mi>L</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">U_1,\ldots,U_L</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">L</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    the orthonormal system of the <strong>eigenvectors</strong> of the matrix <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="bold">S</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{S}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbf">S</span></span></span></span></span> corresponding to these
    eigenvalues.</p>
  <p data-line="81" class="code-line">Set <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>d</mi>
              <mo>=</mo>
              <mo>
                <mrow>
                  <mi mathvariant="normal">r</mi>
                  <mi mathvariant="normal">a</mi>
                  <mi mathvariant="normal">n</mi>
                  <mi mathvariant="normal">k</mi>
                </mrow>
              </mo>
              <mi mathvariant="bold">X</mi>
              <mo>=</mo>
              <mi>max</mi>
              <mo>⁡</mo>
              <mo>{</mo>
              <mi>i</mi>
              <mo>:</mo>
              <msub>
                <mi>λ</mi>
                <mi>i</mi>
              </msub>
              <mo>&gt;</mo>
              <mn>0</mn>
              <mo>}</mo>
            </mrow>
            <annotation encoding="application/x-tex">d= \mathop{\mathrm{rank}} \mathbf{X} =\max\{i : \lambda_i &gt;0\}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
            class="mord mathit">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mop"><span
              class="mord"><span class="mord mathrm">r</span><span class="mord mathrm">a</span><span class="mord mathrm">n</span><span
                class="mord mathrm">k</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="mord"><span class="mord mathbf">X</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span
            class="mopen">{</span><span class="mord mathit">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span
              class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mord">0</span><span class="mclose">}</span></span></span></span> (note that <span class="katex"><span
        class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>d</mi>
              <mo>=</mo>
              <mi>L</mi>
            </mrow>
            <annotation encoding="application/x-tex">d=L</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
            class="mord mathit">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit">L</span></span></span></span>
    for a typical real-life series) and <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>V</mi>
                <mi>i</mi>
              </msub>
              <mo>=</mo>
              <msup>
                <mi mathvariant="bold">X</mi>
                <mi mathvariant="normal">T</mi>
              </msup>
              <msub>
                <mi>U</mi>
                <mi>i</mi>
              </msub>
              <mi mathvariant="normal">/</mi>
              <msqrt>
                <msub>
                  <mi>λ</mi>
                  <mi>i</mi>
                </msub>
              </msqrt>
            </mrow>
            <annotation encoding="application/x-tex">V_i=\mathbf{X}^\mathrm{T} U_i/\sqrt{\lambda_i}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1072199999999999em;vertical-align:-0.25em;"></span><span
            class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t"><span
                  class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mord">/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                  class="vlist" style="height:0.85722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut"
                      style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span
                          class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span
                              class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                    style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail"
                      style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080'
                        preserveAspectRatio='xMinYMin slice'>
                        <path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z' /></svg></span></span></span><span
                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span></span>
    <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mo>(</mo>
              <mi>i</mi>
              <mo>=</mo>
              <mn>1</mn>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <mi>d</mi>
              <mo>)</mo>
            </mrow>
            <annotation encoding="application/x-tex">(i=1,\ldots,d)</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mopen">(</span><span class="mord mathit">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">d</span><span class="mclose">)</span></span></span></span>.
    In this notation, the SVD of the trajectory matrix <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="bold">X</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbf">X</span></span></span></span></span> can be written as</p>
  <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi mathvariant="bold">X</mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="bold">X</mi>
                  <mn>1</mn>
                </msub>
                <mo>+</mo>
                <mo>…</mo>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="bold">X</mi>
                  <mi>d</mi>
                </msub>
                <mo separator="true">,</mo>
              </mrow>
              <annotation encoding="application/x-tex">
                \mathbf{X} = \mathbf{X}_1 + \ldots + \mathbf{X}_d,
              </annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
              class="mord"><span class="mord mathbf">X</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="mord"><span
                class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span
              class="minner">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
              style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span
                  class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                      class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mathit mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mpunct">,</span></span></span></span></span></p>
  <p data-line="87" class="code-line">where
    :<span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi mathvariant="bold">X</mi>
                <mi>i</mi>
              </msub>
              <mo>=</mo>
              <msqrt>
                <msub>
                  <mi>λ</mi>
                  <mi>i</mi>
                </msub>
              </msqrt>
              <msub>
                <mi>U</mi>
                <mi>i</mi>
              </msub>
              <msubsup>
                <mi>V</mi>
                <mi>i</mi>
                <mi mathvariant="normal">T</mi>
              </msubsup>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}_i=\sqrt{\lambda_i}U_i V_i^\mathrm{T}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83611em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1158839999999999em;vertical-align:-0.258664em;"></span><span
            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span
                    class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"
                      style="padding-left:0.833em;"><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                                    style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span
                              class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                    style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail"
                      style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080'
                        preserveAspectRatio='xMinYMin slice'>
                        <path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z' /></svg></span></span></span><span
                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span
                      style="top:-2.441336em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span
                      style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span>
    are matrices having rank 1; these are called ''elementary matrices''. The collection <span class="katex"><span
        class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mo>(</mo>
              <msqrt>
                <msub>
                  <mi>λ</mi>
                  <mi>i</mi>
                </msub>
              </msqrt>
              <mo separator="true">,</mo>
              <msub>
                <mi>U</mi>
                <mi>i</mi>
              </msub>
              <mo separator="true">,</mo>
              <msub>
                <mi>V</mi>
                <mi>i</mi>
              </msub>
              <mo>)</mo>
            </mrow>
            <annotation encoding="application/x-tex">(\sqrt{\lambda_i},U_i,V_i)</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1072199999999999em;vertical-align:-0.25em;"></span><span
            class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                  class="vlist" style="height:0.85722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut"
                      style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span
                          class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span
                              class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                    style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail"
                      style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080'
                        preserveAspectRatio='xMinYMin slice'>
                        <path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z' /></svg></span></span></span><span
                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
              class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
              class="mord mathit" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mclose">)</span></span></span></span> will be called the <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>i</mi>
              </mrow>
              <annotation encoding="application/x-tex">i</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span
              class="mord mathdefault">i</span></span></span></span></eq>th <strong>eigentriple</strong> (abbreviated
    as ET) of the SVD. Vectors <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>U</mi>
                <mi>i</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">U_i</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    are the left singular vectors of the matrix <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="bold">X</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbf">X</span></span></span></span></span>, numbers <span class="katex"><span
        class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msqrt>
                <msub>
                  <mi>λ</mi>
                  <mi>i</mi>
                </msub>
              </msqrt>
            </mrow>
            <annotation encoding="application/x-tex">\sqrt{\lambda_i}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.18278000000000005em;"></span><span
            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span
                    class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"
                      style="padding-left:0.833em;"><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                                    style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span
                              class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                    style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail"
                      style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080'
                        preserveAspectRatio='xMinYMin slice'>
                        <path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z' /></svg></span></span></span><span
                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span></span>
    are the singular values and provide the singular spectrum of <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="bold">X</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbf">X</span></span></span></span></span>; this gives the name to SSA.
    Vectors <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msqrt>
                <msub>
                  <mi>λ</mi>
                  <mi>i</mi>
                </msub>
              </msqrt>
              <msub>
                <mi>V</mi>
                <mi>i</mi>
              </msub>
              <mo>=</mo>
              <msup>
                <mi mathvariant="bold">X</mi>
                <mi mathvariant="normal">T</mi>
              </msup>
              <msub>
                <mi>U</mi>
                <mi>i</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">\sqrt{\lambda_i}V_i=\mathbf{X}^\mathrm{T} U_i</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.18278000000000005em;"></span><span
            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span
                    class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"
                      style="padding-left:0.833em;"><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                                    style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span
                              class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                    style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail"
                      style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080'
                        preserveAspectRatio='xMinYMin slice'>
                        <path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z' /></svg></span></span></span><span
                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.991331em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t"><span
                  class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    are called vectors of principal components (PCs).</p>
  <div style="position:relative;padding-top:56.25%;overflow: hidden;">
    <iframe style="position:absolute;top:0;left:0;width:100%;height:100%;margin: auto;" src="https://jsfiddle.net/shmagrinskiy/wL4652jq/9/embedded/result,js/"
      allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
  </div>
  <h5 id="3rd-step-eigentriple-grouping-1" data-line="95" class="code-line">3rd step: Eigentriple grouping</h5>
  <p data-line="97" class="code-line">Partition the set of indices <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mo>{</mo>
              <mn>1</mn>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <mi>d</mi>
              <mo>}</mo>
            </mrow>
            <annotation encoding="application/x-tex">\{1,\ldots,d\}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">d</span><span
            class="mclose">}</span></span></span></span> into <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>m</mi>
              </mrow>
              <annotation encoding="application/x-tex">m</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
              class="mord mathdefault">m</span></span></span></span></eq> disjoint subsets <span class="katex"><span
        class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>I</mi>
                <mn>1</mn>
              </msub>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <msub>
                <mi>I</mi>
                <mi>m</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">I_1,\ldots,I_m</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
  <p data-line="99" class="code-line">Let <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>I</mi>
              <mo>=</mo>
              <mo>{</mo>
              <msub>
                <mi>i</mi>
                <mn>1</mn>
              </msub>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <msub>
                <mi>i</mi>
                <mi>p</mi>
              </msub>
              <mo>}</mo>
            </mrow>
            <annotation encoding="application/x-tex">I=\{i_1,\ldots,i_p\}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
            class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">{</span><span
            class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">i</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span
                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">p</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span
            class="mclose">}</span></span></span></span>. Then the resultant matrix <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi mathvariant="bold">X</mi>
                <mi>I</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}_I</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83611em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    corresponding to the group <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>I</mi>
              </mrow>
              <annotation encoding="application/x-tex">I</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span></eq> is defined as
    <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi mathvariant="bold">X</mi>
                <mi>I</mi>
              </msub>
              <mo>=</mo>
              <msub>
                <mi mathvariant="bold">X</mi>
                <msub>
                  <mi>i</mi>
                  <mn>1</mn>
                </msub>
              </msub>
              <mo>+</mo>
              <mo>…</mo>
              <mo>+</mo>
              <msub>
                <mi mathvariant="bold">X</mi>
                <msub>
                  <mi>i</mi>
                  <mi>p</mi>
                </msub>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}_I=\mathbf{X}_{i_1}+\ldots+\mathbf{X}_{i_p}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83611em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.93621em;vertical-align:-0.2501em;"></span><span
            class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span
                              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                        class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span
                                          class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span
                                  class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span
            class="minner">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
            style="height:1.03343em;vertical-align:-0.34731999999999996em;"></span><span class="mord"><span class="mord"><span
                class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.31166400000000005em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span
                              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.16454285714285716em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                        class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span
                                          class="mord mathit mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span
                                  class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.34731999999999996em;"><span></span></span></span></span></span></span></span></span></span>.
    The resultant matrices are computed for the groups <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>I</mi>
              <mo>=</mo>
              <msub>
                <mi>I</mi>
                <mn>1</mn>
              </msub>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <msub>
                <mi>I</mi>
                <mi>m</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">I=I_1, \ldots, I_m</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
            class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    and the grouped SVD expansion of <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="bold">X</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbf">X</span></span></span></span></span> can now be written as</p>
  <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi mathvariant="bold">X</mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="bold">X</mi>
                  <msub>
                    <mi>I</mi>
                    <mn>1</mn>
                  </msub>
                </msub>
                <mo>+</mo>
                <mo>…</mo>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="bold">X</mi>
                  <msub>
                    <mi>I</mi>
                    <mi>m</mi>
                  </msub>
                </msub>
                <mi mathvariant="normal">.</mi>
              </mrow>
              <annotation encoding="application/x-tex">
                \mathbf{X}=\mathbf{X}_{I_1}+\ldots+\mathbf{X}_{I_m}.
              </annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span
              class="mord"><span class="mord mathbf">X</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:0.93621em;vertical-align:-0.2501em;"></span><span class="mord"><span
                class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span
                                          class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span
              class="minner">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
              style="height:0.93621em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord"><span
                  class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                      class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span
                                          class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span
                                            class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span
              class="mord">.</span></span></span></span></span></p>
  <div style="position:relative;padding-top:56.25%;overflow: hidden;">
    <iframe style="position:absolute;top:0;left:0;width:100%;height:100%;margin: auto;" src="https://jsfiddle.net/shmagrinskiy/wL4652jq/13/embedded/result,js/"
      allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
  </div>
  <h5 id="4th-step-diagonal-averaging-1" data-line="109" class="code-line">4th step: Diagonal averaging</h5>
  <p data-line="111" class="code-line">Each matrix <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi mathvariant="bold">X</mi>
                <msub>
                  <mi>I</mi>
                  <mi>j</mi>
                </msub>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}_{I_j}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03343em;vertical-align:-0.34731999999999996em;"></span><span
            class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.32833100000000004em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span><span
                              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span
                                        class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span
                                          class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.34731999999999996em;"><span></span></span></span></span></span></span></span></span></span>
    of the grouped decomposition is hankelized and then the obtained <strong>Hankel matrix</strong> is transformed into
    a new series of length <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>N</mi>
              </mrow>
              <annotation encoding="application/x-tex">N</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></eq> using the
    one-to-one correspondence between Hankel matrices and time series.
    Diagonal averaging applied to a resultant matrix <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi mathvariant="bold">X</mi>
                <msub>
                  <mi>I</mi>
                  <mi>k</mi>
                </msub>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf{X}_{I_k}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.94197em;vertical-align:-0.25586em;"></span><span
            class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.55em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span><span
                              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span
                                        class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span
                                          class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25586em;"><span></span></span></span></span></span></span></span></span></span>
    produces a <strong>reconstructed series</strong> <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msup>
                <mover accent="true">
                  <mi mathvariant="double-struck">X</mi>
                  <mo stretchy="true">~</mo>
                </mover>
                <mrow>
                  <mo>(</mo>
                  <mi>k</mi>
                  <mo>)</mo>
                </mrow>
              </msup>
              <mo>=</mo>
              <mo>(</mo>
              <msubsup>
                <mover accent="true">
                  <mi>x</mi>
                  <mo stretchy="true">~</mo>
                </mover>
                <mn>1</mn>
                <mrow>
                  <mo>(</mo>
                  <mi>k</mi>
                  <mo>)</mo>
                </mrow>
              </msubsup>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <msubsup>
                <mover accent="true">
                  <mi>x</mi>
                  <mo stretchy="true">~</mo>
                </mover>
                <mi>N</mi>
                <mrow>
                  <mo>(</mo>
                  <mi>k</mi>
                  <mo>)</mo>
                </mrow>
              </msubsup>
              <mo>)</mo>
            </mrow>
            <annotation encoding="application/x-tex">\widetilde{\mathbb{X}}^{(k)}=(\widetilde{x}^{(k)}_1,\ldots,\widetilde{x}^{(k)}_N)</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.94889em;vertical-align:0em;"></span><span
            class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                    style="height:0.94889em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                        class="mord"><span class="mord"><span class="mord mathbb">X</span></span></span></span><span
                      class="svg-align" style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.68889em;"><span
                        class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em'
                          viewBox='0 0 600 260' preserveAspectRatio='none'>
                          <path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z' /></svg></span></span></span></span></span></span><span
              class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span
                      style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span
                            class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.338331em;vertical-align:-0.29353099999999993em;"></span><span
            class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span
                    class="vlist" style="height:0.6905600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span
                      class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span
                        class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em'
                          viewBox='0 0 600 260' preserveAspectRatio='none'>
                          <path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z' /></svg></span></span></span></span></span></span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span
                      style="top:-2.433692em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span
                      style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span
                            class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span
                  class="vlist-r"><span class="vlist" style="height:0.6905600000000001em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span
                      class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span
                        class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em'
                          viewBox='0 0 600 260' preserveAspectRatio='none'>
                          <path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z' /></svg></span></span></span></span></span></span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span
                      style="top:-2.4064690000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span><span
                      style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span
                            class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29353099999999993em;"><span></span></span></span></span></span></span><span
            class="mclose">)</span></span></span></span>. In this way, the initial series <span class="katex"><span
        class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>x</mi>
                <mn>1</mn>
              </msub>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <msub>
                <mi>x</mi>
                <mi>N</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">x_1,\ldots,x_N</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span
            class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">x</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    is decomposed into a sum of <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>m</mi>
              </mrow>
              <annotation encoding="application/x-tex">m</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
              class="mord mathdefault">m</span></span></span></span></eq> reconstructed subseries:</p>
  <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msub>
                  <mi>x</mi>
                  <mi>n</mi>
                </msub>
                <mo>=</mo>
                <munderover>
                  <mo>∑</mo>
                  <mrow>
                    <mi>k</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mi>m</mi>
                </munderover>
                <msubsup>
                  <mover accent="true">
                    <mi>x</mi>
                    <mo stretchy="true">~</mo>
                  </mover>
                  <mi>n</mi>
                  <mrow>
                    <mo>(</mo>
                    <mi>k</mi>
                    <mo>)</mo>
                  </mrow>
                </msubsup>
                <mtext>  </mtext>
                <mo>(</mo>
                <mi>n</mi>
                <mo>=</mo>
                <mn>1</mn>
                <mo separator="true">,</mo>
                <mn>2</mn>
                <mo separator="true">,</mo>
                <mo>…</mo>
                <mo separator="true">,</mo>
                <mi>N</mi>
                <mo>)</mo>
                <mi mathvariant="normal">.</mi>
              </mrow>
              <annotation encoding="application/x-tex">
                x_n = \sum\limits_{k=1}^m \widetilde{x}^{(k)}_n \ \ (n=1,2, \ldots, N).
              </annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span
              class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.9535100000000005em;vertical-align:-1.302113em;"></span><span
              class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span
                      style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                            style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span
                      style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span
                          class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span
                        class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6905600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathit">x</span></span></span><span class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span
                          class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%'
                            height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'>
                            <path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z' /></svg></span></span></span></span></span></span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span
                        style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span><span
                        style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span
                              class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span
              class="mspace"> </span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathit">n</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></p>
  <h4 id="forecasting-by-ssa-1" data-line="118" class="code-line">Forecasting by SSA</h4>
  <p data-line="120" class="code-line">If for some series <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="double-struck">X</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathbb{X}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathbb">X</span></span></span></span></span> the SVD step in Basic SSA gives
    <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>d</mi>
              <mo>&lt;</mo>
              <mi>L</mi>
            </mrow>
            <annotation encoding="application/x-tex">d&lt;L</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span
            class="mord mathit">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit">L</span></span></span></span>,
    then this series is called <strong>time series of rank</strong>
    <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>d</mi>
              </mrow>
              <annotation encoding="application/x-tex">d</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
              class="mord mathdefault">d</span></span></span></span></eq>. The subspace spanned by the <eq><span class="katex"><span
          class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>d</mi>
              </mrow>
              <annotation encoding="application/x-tex">d</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
              class="mord mathdefault">d</span></span></span></span></eq> leading eigenvectors is called <strong>signal
      subspace</strong>. This subspace is used for estimating the signal parameters in <strong>signal processing</strong>,
    e.g. <strong>Estimation of signal parameters via rotational invariance techniques</strong> for high-resolution
    frequency estimation. Also, this subspace determines the <strong>recurrence relation</strong>. <strong>LRR</strong>
    governing the series, which can be used for forecasting. Continuation of the series by the LRR is similar to
    forward <strong>linear prediction</strong> in signal processing.
  </p>
  <p data-line="122" class="code-line">Let the series be governed by the minimal LRR <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>x</mi>
                <mi>n</mi>
              </msub>
              <mo>=</mo>
              <msubsup>
                <mo>∑</mo>
                <mrow>
                  <mi>k</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mi>d</mi>
              </msubsup>
              <msub>
                <mi>b</mi>
                <mi>k</mi>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mi>n</mi>
                  <mo>−</mo>
                  <mi>k</mi>
                </mrow>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">x_{n}=\sum_{k=1}^d b_k x_{n-k}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2887179999999998em;vertical-align:-0.29971000000000003em;"></span><span
            class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span
                      style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                            style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span
                      style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">b</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">−</span><span
                            class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>.
    Let us choose <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>L</mi>
              <mo>&gt;</mo>
              <mi>d</mi>
            </mrow>
            <annotation encoding="application/x-tex">L&gt;d</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span
            class="mord mathit">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">d</span></span></span></span>,
    <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>U</mi>
                <mn>1</mn>
              </msub>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <msub>
                <mi>U</mi>
                <mi>d</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">U_1,\ldots,U_d</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    be the eigenvectors (left singular vectors of the <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>L</mi>
              </mrow>
              <annotation encoding="application/x-tex">L</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault">L</span></span></span></span></eq>-trajectory matrix), which are provided by the
    SVD step of SSA. Then this series is governed by an LRR <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>x</mi>
                <mi>n</mi>
              </msub>
              <mo>=</mo>
              <msubsup>
                <mo>∑</mo>
                <mrow>
                  <mi>k</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mrow>
                  <mi>L</mi>
                  <mo>−</mo>
                  <mn>1</mn>
                </mrow>
              </msubsup>
              <msub>
                <mi>a</mi>
                <mi>k</mi>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mi>n</mi>
                  <mo>−</mo>
                  <mi>k</mi>
                </mrow>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">x_{n}=\sum_{k=1}^{L-1} a_k x_{n-k}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-0.29971000000000003em;"></span><span
            class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span
                      style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                            style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span
                      style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">L</span><span
                            class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">a</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">−</span><span
                            class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>,
    where <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mo>(</mo>
              <msub>
                <mi>a</mi>
                <mrow>
                  <mi>L</mi>
                  <mo>−</mo>
                  <mn>1</mn>
                </mrow>
              </msub>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <msub>
                <mi>a</mi>
                <mn>1</mn>
              </msub>
              <msup>
                <mo>)</mo>
                <mi mathvariant="normal">T</mi>
              </msup>
            </mrow>
            <annotation encoding="application/x-tex">(a_{L-1},\ldots,a_1)^\mathrm{T}</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span
            class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span
                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">L</span><span
                            class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">a</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                    class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span></span></span></span>
    are expressed through <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>U</mi>
                <mn>1</mn>
              </msub>
              <mo separator="true">,</mo>
              <mo>…</mo>
              <mo separator="true">,</mo>
              <msub>
                <mi>U</mi>
                <mi>d</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">U_1,\ldots,U_d</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace"
            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    (Golyandina et al., 2001, Ch.5), and can be continued by the same LRR.</p>
  <p data-line="124" class="code-line">This provides the basis for SSA recurrent and vector forecasting algorithms
    (Golyandina et al., 2001, Ch.2). In practice, the signal is corrupted by a perturbation, e.g., by noise, and its
    subspace is estimated by SSA approximately. Thus, SSA forecasting can be applied for forecasting of a time series
    component that is approximately governed by an LRR and is approximately separated from the residual.</p>
  <h3 id="using-libraries-1" data-line="126" class="code-line">Using libraries</h3>
  <h4 id="smile-1" data-line="128" class="code-line">Smile</h4>
  <p data-line="130" class="code-line"><img src="https://haifengl.github.io/smile/images/smile.jpg" alt="" class="loading"
      id="image-hash-dcb265c264bc199ad3de240ec9c707db04345a443e7e33f39c80414c6dc19428"></p>
  <p data-line="132" class="code-line">Smile is a comprehensive Java library of various state-of-art machine learning
    algorithms. The major components include:</p>
  <ul>
    <li data-line="134" class="code-line"><strong>Core</strong> The core machine learning library</li>
    <li data-line="135" class="code-line"><strong>Math</strong> Mathematical functions (basic, special, kernel,
      distance, rbf, etc.), sorting, random number generators, optimization, linear algebra, statistical distributions,
      and hypothesis testing.</li>
    <li data-line="136" class="code-line"><strong>Data</strong> Parsers for arff, libsvm, delimited text, sparse
      matrix, microarray gene expression data.</li>
    <li data-line="137" class="code-line"><strong>Graph</strong> Graph algorithms on adjacency list and matrix.</li>
    <li data-line="138" class="code-line"><strong>Interpolation</strong> One and two dimensional interpolation.</li>
    <li data-line="139" class="code-line"><strong>NLP</strong> Natural Language Processing.</li>
    <li data-line="140" class="code-line"><strong>Plot</strong> Swing-based data visualization library</li>
  </ul>
  <h5 id="using-for-in-the-package-4" data-line="142" class="code-line">Using for in the package</h5>
  <ul>
    <li data-line="144" class="code-line">Matricies manipulation</li>
    <li data-line="145" class="code-line">SVD Lanczos algorithm implementation</li>
    <li data-line="146" class="code-line">Lapack Wrappers for java</li>
    <li data-line="147" class="code-line">Hierararchial clustering on grouping stage.</li>
  </ul>
  <h4 id="lapack-1" data-line="149" class="code-line">Lapack</h4>
  <p data-line="151" class="code-line"><img src="http://www.netlib.org/lapack/images/lapack1.jpg" alt="" class="loading"
      id="image-hash-64cec21ba74f11e3e98c8d9b6c60d1fed81bcd837a09ea27208188c2671d37e3"></p>
  <p data-line="153" class="code-line"><strong>Linear Algebra PACKage</strong> is written in Fortran 90 and provides
    routines for solving systems of simultaneous linear equations, least-squares solutions of linear systems of
    equations, eigenvalue problems, and singular value problems. The associated matrix factorizations (LU, Cholesky,
    QR, SVD, Schur, generalized Schur) are also provided, as are related computations such as reordering of the Schur
    factorizations and estimating condition numbers. Dense and banded matrices are handled, but not general sparse
    matrices. In all areas, similar functionality is provided for real and complex matrices, in both single and double
    precision.</p>
  <h5 id="using-for-in-the-package-5" data-line="155" class="code-line">Using for in the package</h5>
  <ul>
    <li data-line="156" class="code-line">SVD</li>
  </ul>
  <h4 id="apache-commons-math-1" data-line="158" class="code-line">Apache commons-math</h4>
  <p data-line="160" class="code-line"><img src="http://commons.apache.org/proper/commons-math/images/math.gif" alt=""
      class="loading" id="image-hash-899e8ff300f11a5571c0eeeafe94f90797009613f8eee74abc39eca93884c3a9"></p>
  <p data-line="162" class="code-line"><strong>Commons Math</strong> is a library of lightweight, self-contained
    mathematics and statistics components addressing the most common problems not available in the Java programming
    language or Commons Lang.</p>
  <h5 id="using-for-in-the-package-6" data-line="164" class="code-line">Using for in the package</h5>
  <ul>
    <li data-line="166" class="code-line">Vector manipulation (legacy)</li>
  </ul>
  <h4 id="jtransoforms-1" data-line="168" class="code-line">JTransoforms</h4>
  <p data-line="170" class="code-line">JTransforms is the first, open source, multithreaded FFT library written in pure
    Java. Currently, four types of transforms are available: Discrete Fourier Transform (DFT), Discrete Cosine
    Transform (DCT), Discrete Sine Transform (DST) and Discrete Hartley Transform (DHT).</p>
  <h5 id="using-for-in-the-package-7" data-line="172" class="code-line">Using for in the package</h5>
  <ul>
    <li data-line="174" class="code-line">Fast matrix-vector multiplication for Hankel Matrix using FFT</li>
    <li data-line="175" class="code-line">Fast diagonal averaging using FFT</li>
  </ul>
  <h2 id="implementation-1" data-line="177" class="code-line">Implementation</h2>
  <h3 id="embedding-1" data-line="179" class="code-line">Embedding</h3>
  <p data-line="181" class="code-line"><a href="https://github.com/unrealwork/ssa-java/blob/master/src/main/java/com/axibase/ssa/SSAUtils.java#L46">Building
      of trajectory matrix</a></p>
  <pre><code data-line="183" class="code-line language-java"><div><span class="hljs-comment">/**
   * Build trajectory matrix
   *
   * <span class="hljs-doctag">@param</span> series source series
   * <span class="hljs-doctag">@param</span> windowSize size of window
   * <span class="hljs-doctag">@return</span> result matrix
   */</span>
  <span class="hljs-function">Matrix <span class="hljs-title">embedding</span><span class="hljs-params">(<span class="hljs-keyword">double</span>[] series, <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> windowSize, <span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> isFourier)</span> </span>{
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> seriesSize = series.length;
    <span class="hljs-keyword">if</span> (windowSize &gt; seriesSize / <span class="hljs-number">2</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(String
          .format(<span class="hljs-string">"Window size should be not less than half series size: %d &gt; %d"</span>, windowSize,
              seriesSize / <span class="hljs-number">2</span>));
    }

    <span class="hljs-keyword">if</span> (isFourier &amp;&amp; windowSize &gt; TRUNCATED_SVD_THRESHOLD) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TrajectoryMatrix(series, windowSize);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> ncols = seriesSize - windowSize + <span class="hljs-number">1</span>;
      <span class="hljs-keyword">double</span>[][] matrix = <span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[windowSize][ncols];
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; ncols; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; windowSize; j++) {
          matrix[j][i] = series[j + i];
        }
      }
      <span class="hljs-keyword">final</span> JMatrix jMatrix = <span class="hljs-keyword">new</span> NLMatrix(matrix);
      jMatrix.setSymmetric(<span class="hljs-keyword">true</span>);
      <span class="hljs-keyword">return</span> jMatrix;
    }
  }
</div></code></pre>
  <blockquote data-line="216" class="code-line">
    <p data-line="216" class="code-line">Note: in case of fast-multiplication, it's enough to store only series and
      window length.</p>
  </blockquote>
  <h3 id="singular-value-decomposition-1" data-line="218" class="code-line">Singular Value Decomposition</h3>
  <p data-line="220" class="code-line">There are two algorithms main algorithms that we use for SVD.</p>
  <ol>
    <li data-line="222" class="code-line">
      <p data-line="222" class="code-line">The Lanczos algorithm is a direct algorithm devised by Cornelius Lanczos
        that is an adaptation of power methods to find the most useful eigenvalues and eigenvectors of an nth order
        linear system with a limited number of operations, m, where m is much smaller than n. Although computationally
        efficient in principle, the method as initially formulated was not useful, due to its numerical instability. In
        this implementation, we use partial reorthogonalization to make the method numerically stable.</p>
    </li>
    <li data-line="224" class="code-line">
      <p data-line="224" class="code-line">Full SVD implemented by LAPACK. The divide and conquer algorithm makes very
        mild assumptions about floating point arithmetic.</p>
    </li>
  </ol>
  <p data-line="226" class="code-line">Usually the SVD is computed by means of Golub and Reinsh algorithm which
    requires <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>O</mi>
              <mrow>
                <mo fence="true">(</mo>
                <msup>
                  <mi>L</mi>
                  <mn>2</mn>
                </msup>
                <mi>K</mi>
                <mo>+</mo>
                <mi>L</mi>
                <msup>
                  <mi>K</mi>
                  <mn>2</mn>
                </msup>
                <mo>+</mo>
                <msup>
                  <mi>K</mi>
                  <mn>3</mn>
                </msup>
                <mo fence="true">)</mo>
              </mrow>
            </mrow>
            <annotation encoding="application/x-tex">O \left( L ^ { 2 } K + L K ^ { 2 } + K ^ { 3 } \right)</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span
            class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span
              class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span
              class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span
              class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">L</span><span
              class="mord"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span
                        style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span
                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span
                        style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span
              class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span>
    multiplications having the worst computational complexity of <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>O</mi>
              <mrow>
                <mo fence="true">(</mo>
                <msup>
                  <mi>N</mi>
                  <mn>3</mn>
                </msup>
                <mo fence="true">)</mo>
              </mrow>
            </mrow>
            <annotation encoding="application/x-tex">O \left( N ^ { 3 } \right)</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span
            class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span
              class="mord"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span
                        style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span
              class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span>
    when <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>K</mi>
              <mo>∼</mo>
              <mi>L</mi>
              <mo>∼</mo>
              <mi>N</mi>
              <mi mathvariant="normal">/</mi>
              <mn>2.</mn>
            </mrow>
            <annotation encoding="application/x-tex">K \sim L \sim N / 2 .</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
            class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit">L</span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord">/</span><span class="mord">2</span><span
            class="mord">.</span></span></span></span> Note that all the data must be processed at once and SVDs even
    of moderate length time series (say, when<span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>N</mi>
              <mo>&gt;</mo>
              <mn>5000</mn>
            </mrow>
            <annotation encoding="application/x-tex">N &gt; 5000</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span
            class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span
            class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span> ) are
    essentially unfeasible.</p>
  <p data-line="228" class="code-line">The computational complexity of the Lanczos bidiagonalization is determined by
    the two matrix-vector multiplications, thus the overall complexity of <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>k</mi>
              </mrow>
              <annotation encoding="application/x-tex">k</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></eq> Lanczos
    iterations in exact arithmetics is <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>O</mi>
              <mo>(</mo>
              <mi>k</mi>
              <mi>L</mi>
              <mi>K</mi>
              <mo>)</mo>
            </mrow>
            <annotation encoding="application/x-tex">O ( k L K )</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathit"
            style="margin-right:0.03148em;">k</span><span class="mord mathit">L</span><span class="mord mathit" style="margin-right:0.07153em;">K</span><span
            class="mclose">)</span></span></span></span> multiplications.</p>
  <p data-line="232" class="code-line">If the matrix being decomposed is sparse or structured (for example, Hankel
    in Basic SSA case or Hankel with Hankel blocks for 2<span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="normal">D</mi>
            </mrow>
            <annotation encoding="application/x-tex">\mathrm { D }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathrm">D</span></span></span></span></span> -SSA) then the compu-
    tational complexity of the bidiagonalization can be significantly reduced given
    that the efficient matrix-vector multiplication routine is available.</p>
  <h4 id="matrix-vector-multiplication-for-ssa-trajectory-matrix-1" data-line="237" class="code-line">Matrix-Vector
    Multiplication for SSA Trajectory Matrix</h4>
  <p data-line="239" class="code-line"><strong>Input</strong>: Time series <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>F</mi>
              <mo>=</mo>
              <msubsup>
                <mrow>
                  <mo fence="true">(</mo>
                  <msub>
                    <mi>f</mi>
                    <mi>j</mi>
                  </msub>
                  <mo fence="true">)</mo>
                </mrow>
                <mrow>
                  <mi>j</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mi>N</mi>
              </msubsup>
              <mo separator="true">,</mo>
            </mrow>
            <annotation encoding="application/x-tex">F = \left( f _ { j } \right) _ { j = 1 } ^ { N } ,</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
            class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:1.453147em;vertical-align:-0.471916em;"></span><span class="minner"><span
              class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathit"
                  style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span
                class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.364192em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span
                            class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span
                      style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                            style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.471916em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span></span></span></span>
    window length <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>L</mi>
              <mo separator="true">,</mo>
            </mrow>
            <annotation encoding="application/x-tex">L ,</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
            class="mord mathit">L</span><span class="mpunct">,</span></span></span></span> vector <eq><span class="katex"><span
          class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>v</mi>
              </mrow>
              <annotation encoding="application/x-tex">v</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span></eq> of length
    <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>N</mi>
              <mo>−</mo>
              <mi>L</mi>
              <mo>+</mo>
              <mn>1.</mn>
            </mrow>
            <annotation encoding="application/x-tex">N - L + 1 .</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span
            class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
          class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathit">L</span><span
            class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
            class="mord">1</span><span class="mord">.</span></span></span></span></p>
  <p data-line="242" class="code-line"><strong>Output</strong>: <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>p</mi>
              <mo>=</mo>
              <mi>X</mi>
              <mi>v</mi>
              <mo separator="true">,</mo>
            </mrow>
            <annotation encoding="application/x-tex">p = X v ,</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span
            class="mord mathit">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
            class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span
            class="mpunct">,</span></span></span></span> where <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>X</mi>
              </mrow>
              <annotation encoding="application/x-tex">X</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span></eq> is a
    trajectory matrix for <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>F</mi>
              </mrow>
              <annotation encoding="application/x-tex">F</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></eq> given window
    length <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>L</mi>
              <mi mathvariant="normal">.</mi>
            </mrow>
            <annotation encoding="application/x-tex">L .</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
            class="mord mathit">L</span><span class="mord">.</span></span></span></span></p>
  <hr>
  <ol>
    <li data-line="247" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>c</mi>
                <mo>←</mo>
                <msup>
                  <mrow>
                    <mo fence="true">(</mo>
                    <msub>
                      <mi>f</mi>
                      <mrow>
                        <mi>N</mi>
                        <mo>−</mo>
                        <mi>L</mi>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>f</mi>
                      <mi>N</mi>
                    </msub>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>f</mi>
                      <mn>1</mn>
                    </msub>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>f</mi>
                      <mrow>
                        <mi>N</mi>
                        <mo>−</mo>
                        <mi>L</mi>
                      </mrow>
                    </msub>
                    <mo fence="true">)</mo>
                  </mrow>
                  <mi>T</mi>
                </msup>
              </mrow>
              <annotation encoding="application/x-tex">c \leftarrow \left( f _ { N - L + 1 } , \ldots , f _ { N } , f _
                { 1 } , \ldots , f _ { N - L } \right) ^ { T }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
              class="mord mathit">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1.231231em;vertical-align:-0.25em;"></span><span class="minner"><span
                class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathit"
                    style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span
                                  class="mbin mtight">−</span><span class="mord mathit mtight">L</span><span class="mbin mtight">+</span><span
                                  class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                  class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                  class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                  class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span
                                  class="mord mathit mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span
                  class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span
                    class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></li>
    <li data-line="248" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mover accent="true">
                  <mi>c</mi>
                  <mo>^</mo>
                </mover>
                <mo>←</mo>
                <mi>F</mi>
                <mi>F</mi>
                <msub>
                  <mi>T</mi>
                  <mi>N</mi>
                </msub>
                <mo>(</mo>
                <mi>c</mi>
                <mo>)</mo>
              </mrow>
              <annotation encoding="application/x-tex">\hat { c } \leftarrow F F T _ { N } ( c )</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
              class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">c</span></span></span><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span
              class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span></li>
    <li data-line="249" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>w</mi>
                <mo>←</mo>
                <msup>
                  <mrow>
                    <mo fence="true">(</mo>
                    <msub>
                      <mi>v</mi>
                      <mrow>
                        <mi>N</mi>
                        <mo>−</mo>
                        <mi>L</mi>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>v</mi>
                      <mn>1</mn>
                    </msub>
                    <mo separator="true">,</mo>
                    <mn>0</mn>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <mn>0</mn>
                    <mo fence="true">)</mo>
                  </mrow>
                  <mi>T</mi>
                </msup>
              </mrow>
              <annotation encoding="application/x-tex">w \leftarrow \left( v _ { N - L + 1 } , \dots , v _ { 1 } , 0 ,
                \ldots , 0 \right) ^ { T }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
              class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1.231231em;vertical-align:-0.25em;"></span><span class="minner"><span
                class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathit"
                    style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span
                                  class="mbin mtight">−</span><span class="mord mathit mtight">L</span><span class="mbin mtight">+</span><span
                                  class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                  class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord">0</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></li>
    <li data-line="250" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mover accent="true">
                  <mi>w</mi>
                  <mo>^</mo>
                </mover>
                <mo>←</mo>
                <mi>F</mi>
                <mi>F</mi>
                <msub>
                  <mi>T</mi>
                  <mi>N</mi>
                </msub>
                <mo>(</mo>
                <mi>w</mi>
                <mo>)</mo>
              </mrow>
              <annotation encoding="application/x-tex">\hat { w } \leftarrow F F T _ { N } ( w )</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
              class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit"
                          style="margin-right:0.02691em;">w</span></span></span><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span
              class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span></li>
    <li data-line="251" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msup>
                  <mi>p</mi>
                  <mo mathvariant="normal">′</mo>
                </msup>
                <mo>←</mo>
                <mi>I</mi>
                <mi>F</mi>
                <mi>F</mi>
                <msub>
                  <mi>T</mi>
                  <mi>N</mi>
                </msub>
                <mo>(</mo>
                <mover accent="true">
                  <mi>w</mi>
                  <mo>^</mo>
                </mover>
                <mo>⊙</mo>
                <mover accent="true">
                  <mi>c</mi>
                  <mo>^</mo>
                </mover>
                <mo>)</mo>
              </mrow>
              <annotation encoding="application/x-tex">p ^ { \prime } \leftarrow I F F T _ { N } ( \hat { w } \odot
                \hat { c } )</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span
              class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span
              class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathit"
                style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                    style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                        class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">c</span></span></span><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></li>
    <li data-line="252" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>p</mi>
                <mo>←</mo>
                <msup>
                  <mrow>
                    <mo fence="true">(</mo>
                    <msubsup>
                      <mi>p</mi>
                      <mn>1</mn>
                      <mo mathvariant="normal">′</mo>
                    </msubsup>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <msubsup>
                      <mi>p</mi>
                      <mi>L</mi>
                      <mo mathvariant="normal">′</mo>
                    </msubsup>
                    <mo fence="true">)</mo>
                  </mrow>
                  <mi>T</mi>
                </msup>
              </mrow>
              <annotation encoding="application/x-tex">p \leftarrow \left( p _ { 1 } ^ { \prime } , \ldots , p _ { L }
                ^ { \prime } \right) ^ { T }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span
              class="mord mathit">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1.258454em;vertical-align:-0.275331em;"></span><span class="minner"><span
                class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathit">p</span><span
                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span
                            style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                  class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.424669em;margin-left:0em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight"><span class="mord mathit mtight">L</span></span></span></span><span
                            style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.275331em;"><span></span></span></span></span></span></span><span
                  class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span
                    class="vlist-r"><span class="vlist" style="height:0.983123em;"><span style="top:-3.2047920000000003em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></li>
  </ol>
  <hr>
  <p data-line="255" class="code-line">where <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mo>(</mo>
              <mover accent="true">
                <mi>w</mi>
                <mo>^</mo>
              </mover>
              <mo>⊙</mo>
              <mover accent="true">
                <mi>c</mi>
                <mo>^</mo>
              </mover>
              <mo>)</mo>
            </mrow>
            <annotation encoding="application/x-tex">( \hat { w } \odot \hat { c } )</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                  style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                      class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span
                    style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace"
            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                    style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">c</span></span></span><span
                    style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span><span
            class="mclose">)</span></span></span></span> denotes element-wise vector multiplication.</p>
  <pre><code data-line="257" class="code-line language-java"><div>  <span class="hljs-meta">@Override</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span>[] ax(<span class="hljs-keyword">double</span>[] x, <span class="hljs-keyword">double</span>[] y) {
    <span class="hljs-keyword">double</span>[] w = fillVectorAfter(x, series.length);
    <span class="hljs-keyword">double</span>[] wDft = dft.fft(w);
    MatrixUtils.wiseMultiplication(wDft, seriesDft);
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] ifft = dft.ifft(wDft);
    System.arraycopy(ifft, <span class="hljs-number">0</span>, y, <span class="hljs-number">0</span>, nrows);
    <span class="hljs-keyword">return</span> y;
}
</div></code></pre>
  <p data-line="269" class="code-line">If the matrix-vector multiplication <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>X</mi>
              <mi>v</mi>
            </mrow>
            <annotation encoding="application/x-tex">X v</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
            class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>
    is performed repeatedly with the same
    matrix <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>X</mi>
              </mrow>
              <annotation encoding="application/x-tex">X</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span></eq> and different
    vectors <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>v</mi>
              </mrow>
              <annotation encoding="application/x-tex">v</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span></eq> then steps
    <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mn>1</mn>
              <mo separator="true">,</mo>
              <mn>2</mn>
            </mrow>
            <annotation encoding="application/x-tex">1,2</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span
            class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="mord">2</span></span></span></span> should be performed only once
    at the beginning and the resulting vector <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mover accent="true">
                <mi>c</mi>
                <mo>^</mo>
              </mover>
            </mrow>
            <annotation encoding="application/x-tex">\hat { c }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
            class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                    style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">c</span></span></span><span
                    style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span></span></span></span>
    should be reused later on.</p>
  <pre><code data-line="273" class="code-line language-java"><div>TrajectoryMatrix(<span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] series, <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> windowSize) {
    ...
    <span class="hljs-keyword">double</span>[] c = SSAUtils.fftRearrange(series, nrows);
    <span class="hljs-keyword">this</span>.dft = <span class="hljs-keyword">new</span> FFTransformer(series.length);
    <span class="hljs-keyword">this</span>.seriesDft = dft.fft(c);
    ...
}
</div></code></pre>
  <p data-line="283" class="code-line">The overall computational complexity of the matrix-vector multiplication
    is <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>O</mi>
              <mo>(</mo>
              <mi>N</mi>
              <mi>log</mi>
              <mo>⁡</mo>
              <mi>N</mi>
              <mo>)</mo>
              <mi mathvariant="normal">.</mi>
            </mrow>
            <annotation encoding="application/x-tex">O ( N \log N ) .</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathit"
            style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mord">.</span></span></span></span>
    Memory space of size <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>O</mi>
              <mo>(</mo>
              <mi>N</mi>
              <mo>)</mo>
            </mrow>
            <annotation encoding="application/x-tex">O ( N )</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathit"
            style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> is required to
    store precomputed
    vector <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mover accent="true">
                <mi>c</mi>
                <mo>^</mo>
              </mover>
              <mi mathvariant="normal">.</mi>
            </mrow>
            <annotation encoding="application/x-tex">\hat { c } .</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
            class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                    style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">c</span></span></span><span
                    style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span><span
            class="mord">.</span></span></span></span></p>
  <h4 id="matrix-vector-multiplication-for-transpose-of-ssa-trajectory-matrix-1" data-line="287" class="code-line">Matrix-Vector
    Multiplication for transpose of SSA Trajectory Matrix</h4>
  <p data-line="289" class="code-line"><strong>Input</strong>: Time series <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>F</mi>
              <mo>=</mo>
              <msubsup>
                <mrow>
                  <mo fence="true">(</mo>
                  <msub>
                    <mi>f</mi>
                    <mi>j</mi>
                  </msub>
                  <mo fence="true">)</mo>
                </mrow>
                <mrow>
                  <mi>j</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mi>N</mi>
              </msubsup>
              <mo separator="true">,</mo>
            </mrow>
            <annotation encoding="application/x-tex">F = \left( f _ { j } \right) _ { j = 1 } ^ { N } ,</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
            class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:1.453147em;vertical-align:-0.471916em;"></span><span class="minner"><span
              class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathit"
                  style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span
                class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.364192em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span
                            class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span
                      style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                            style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.471916em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span></span></span></span>
    window length <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>L</mi>
              <mo separator="true">,</mo>
            </mrow>
            <annotation encoding="application/x-tex">L ,</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
            class="mord mathit">L</span><span class="mpunct">,</span></span></span></span> vector <eq><span class="katex"><span
          class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>v</mi>
              </mrow>
              <annotation encoding="application/x-tex">v</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span></eq> of length <eq><span
        class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>L</mi>
              </mrow>
              <annotation encoding="application/x-tex">L</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault">L</span></span></span></span></eq> .</p>
  <p data-line="291" class="code-line"><strong>Output</strong>: <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>p</mi>
              <mo>=</mo>
              <msup>
                <mi>X</mi>
                <mi>T</mi>
              </msup>
              <mi>v</mi>
              <mo separator="true">,</mo>
            </mrow>
            <annotation encoding="application/x-tex">p = X ^ { T } v ,</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span
            class="mord mathit">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="mord"><span
              class="mord mathit" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span
                  class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span
            class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span></span></span></span>
    where <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>X</mi>
              </mrow>
              <annotation encoding="application/x-tex">X</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span></eq> is a
    trajectory matrix for <eq><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>F</mi>
              </mrow>
              <annotation encoding="application/x-tex">F</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></eq> given window
    length <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>L</mi>
              <mi mathvariant="normal">.</mi>
            </mrow>
            <annotation encoding="application/x-tex">L .</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
            class="mord mathit">L</span><span class="mord">.</span></span></span></span></p>
  <hr>
  <ol>
    <li data-line="296" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>c</mi>
                <mo>←</mo>
                <msup>
                  <mrow>
                    <mo fence="true">(</mo>
                    <msub>
                      <mi>f</mi>
                      <mrow>
                        <mi>N</mi>
                        <mo>−</mo>
                        <mi>L</mi>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>f</mi>
                      <mi>N</mi>
                    </msub>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>f</mi>
                      <mn>1</mn>
                    </msub>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>f</mi>
                      <mrow>
                        <mi>N</mi>
                        <mo>−</mo>
                        <mi>L</mi>
                      </mrow>
                    </msub>
                    <mo fence="true">)</mo>
                  </mrow>
                  <mi>T</mi>
                </msup>
              </mrow>
              <annotation encoding="application/x-tex">c \leftarrow \left( f _ { N - L + 1 } , \ldots , f _ { N } , f _
                { 1 } , \ldots , f _ { N - L } \right) ^ { T }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
              class="mord mathit">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1.231231em;vertical-align:-0.25em;"></span><span class="minner"><span
                class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathit"
                    style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span
                                  class="mbin mtight">−</span><span class="mord mathit mtight">L</span><span class="mbin mtight">+</span><span
                                  class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                  class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                  class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                  class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span
                                  class="mord mathit mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span
                  class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span
                    class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></li>
    <li data-line="297" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mover accent="true">
                  <mi>c</mi>
                  <mo>^</mo>
                </mover>
                <mo>←</mo>
                <mi>F</mi>
                <mi>F</mi>
                <msub>
                  <mi>T</mi>
                  <mi>N</mi>
                </msub>
                <mo>(</mo>
                <mi>c</mi>
                <mo>)</mo>
              </mrow>
              <annotation encoding="application/x-tex">\hat { c } \leftarrow F F T _ { N } ( c )</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
              class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">c</span></span></span><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span
              class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span></li>
    <li data-line="298" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>w</mi>
                <mo>←</mo>
                <msup>
                  <mrow>
                    <mo fence="true">(</mo>
                    <mn>0</mn>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <mn>0</mn>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>v</mi>
                      <mi>L</mi>
                    </msub>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>v</mi>
                      <mn>1</mn>
                    </msub>
                    <mo fence="true">)</mo>
                  </mrow>
                  <mi>T</mi>
                </msup>
              </mrow>
              <annotation encoding="application/x-tex">w \leftarrow \left( 0 , \ldots , 0 , v _ { L } , \ldots , v _ {
                1 } \right) ^ { T }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
              class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1.231231em;vertical-align:-0.25em;"></span><span class="minner"><span
                class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">0</span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                  class="mord mathit mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                  class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span
                    class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></li>
    <li data-line="299" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mover accent="true">
                  <mi>w</mi>
                  <mo>^</mo>
                </mover>
                <mo>←</mo>
                <mi>F</mi>
                <mi>F</mi>
                <msub>
                  <mi>T</mi>
                  <mi>N</mi>
                </msub>
                <mo>(</mo>
                <mi>w</mi>
                <mo>)</mo>
              </mrow>
              <annotation encoding="application/x-tex">\hat { w } \leftarrow F F T _ { N } ( w )</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
              class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit"
                          style="margin-right:0.02691em;">w</span></span></span><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span
              class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span></li>
    <li data-line="300" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msup>
                  <mi>p</mi>
                  <mo mathvariant="normal">′</mo>
                </msup>
                <mo>←</mo>
                <mi>I</mi>
                <mi>F</mi>
                <mi>F</mi>
                <msub>
                  <mi>T</mi>
                  <mi>N</mi>
                </msub>
                <mo>(</mo>
                <mover accent="true">
                  <mi>w</mi>
                  <mo>^</mo>
                </mover>
                <mo>⊙</mo>
                <mover accent="true">
                  <mi>c</mi>
                  <mo>^</mo>
                </mover>
                <mo>)</mo>
              </mrow>
              <annotation encoding="application/x-tex">p ^ { \prime } \leftarrow I F F T _ { N } ( \hat { w } \odot
                \hat { c } )</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span
              class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span
              class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathit"
                style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                    style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                        class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">c</span></span></span><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></li>
    <li data-line="301" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>p</mi>
                <mo>←</mo>
                <msup>
                  <mrow>
                    <mo fence="true">(</mo>
                    <msubsup>
                      <mi>p</mi>
                      <mrow>
                        <mi>L</mi>
                        <mo>−</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo mathvariant="normal">′</mo>
                    </msubsup>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <msubsup>
                      <mi>p</mi>
                      <mi>N</mi>
                      <mo mathvariant="normal">′</mo>
                    </msubsup>
                    <mo fence="true">)</mo>
                  </mrow>
                  <mi>T</mi>
                </msup>
              </mrow>
              <annotation encoding="application/x-tex">p \leftarrow \left( p _ { L - 1 } ^ { \prime } , \ldots , p _ {
                N } ^ { \prime } \right) ^ { T }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span
              class="mord mathit">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1.4312409999999998em;vertical-align:-0.35001em;"></span><span
              class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span
                  class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.424669em;margin-left:0em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight"><span class="mord mathit mtight">L</span><span class="mbin mtight">−</span><span
                                  class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.333662em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.424669em;margin-left:0em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span><span
                            style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.275331em;"><span></span></span></span></span></span></span><span
                  class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span
                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0812309999999998em;"><span
                        style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                              style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></li>
  </ol>
  <hr>
  <pre><code data-line="305" class="code-line language-java"><div> <span class="hljs-meta">@Override</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span>[] atx(<span class="hljs-keyword">double</span>[] x, <span class="hljs-keyword">double</span>[] y) {
    <span class="hljs-keyword">double</span>[] w = fillVectorBefore(x, series.length);
    <span class="hljs-keyword">double</span>[] wDft = dft.fft(w);
    MatrixUtils.wiseMultiplication(wDft, seriesDft);
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] ifft = dft.ifft(wDft);
    System.arraycopy(ifft, series.length - ncols, y, <span class="hljs-number">0</span>, ncols);
    <span class="hljs-keyword">return</span> y;
}
</div></code></pre>
  <h5 id="decomposition-code-1" data-line="317" class="code-line">Decomposition code</h5>
  <pre><code data-line="319" class="code-line language-java"><div><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SvdHolder <span class="hljs-title">decomposition</span><span class="hljs-params">(<span class="hljs-keyword">final</span> @NotNull Matrix original,
      <span class="hljs-keyword">final</span> ForecastConfiguration configuration)</span> </span>{
    log.debug(<span class="hljs-string">"Svd start"</span>);
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> desiredRank = Math.min(configuration.getDesiredRank(),
        Math.min(original.ncols(), original.nrows()));
    <span class="hljs-keyword">final</span> SVD svd = applySvd(original, configuration, desiredRank);
    log.debug(<span class="hljs-string">"True svd finished"</span>);
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> seriesSize = original.ncols() + original.nrows() - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">final</span> Matrix uMatrix = svd.getU();
    <span class="hljs-keyword">int</span> rank = Math.min(desiredRank, uMatrix.ncols());
    <span class="hljs-keyword">final</span> Reconstructer reconstructer = <span class="hljs-keyword">new</span> Reconstructer(<span class="hljs-keyword">new</span> FFTransformer(seriesSize),
        configuration.getAverageFunction(), configuration.isFourier(), rank);
    <span class="hljs-keyword">final</span> Map&lt;Integer, <span class="hljs-keyword">double</span>[]&gt; reconstructed = reconstructer.getReconstructed(svd);
    <span class="hljs-keyword">while</span> (Double.isNaN(svd.getSingularValues()[rank - <span class="hljs-number">1</span>])) {
      rank--;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SvdHolderTrajectory(uMatrix, seriesSize, rank, reconstructed);
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> SVD <span class="hljs-title">applySvd</span><span class="hljs-params">(<span class="hljs-keyword">final</span> @NotNull Matrix original,
      <span class="hljs-keyword">final</span> ForecastConfiguration configuration,
      <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> desiredRank)</span> </span>{
    <span class="hljs-keyword">final</span> SvdMethod svdMethod = configuration.getSvdMethod();
    <span class="hljs-keyword">switch</span> (svdMethod) {
      <span class="hljs-keyword">case</span> FULL:
        <span class="hljs-keyword">if</span> (configuration.isFourier()) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(<span class="hljs-string">"Full svd is not implemented for Hankel matrices yet"</span>);
        }
        JMatrix matrix = (JMatrix) original;
        <span class="hljs-keyword">return</span> matrix.svd();
      <span class="hljs-keyword">case</span> AUTO:
        <span class="hljs-keyword">if</span> (configuration.getWindowLength() &lt; TRUNCATED_SVD_THRESHOLD) {
          <span class="hljs-keyword">return</span> ((DenseMatrix) original).svd();
        }
        <span class="hljs-keyword">return</span> original.svd(desiredRank);
      <span class="hljs-keyword">case</span> TRUNCATED:
        <span class="hljs-keyword">return</span> original.svd(desiredRank);
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(String.format(<span class="hljs-string">"Unexpected svd method: %s"</span>, svdMethod));
    }
}
</div></code></pre>
  <h4 id="reconstructionhankelization-1" data-line="363" class="code-line">Reconstruction(hankelization)</h4>
  <p data-line="365" class="code-line">Allows to calculate reconstrucred series for each eigentriple from SVD.</p>
  <hr>
  <ol>
    <li data-line="369" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msup>
                  <mi>u</mi>
                  <mo mathvariant="normal">′</mo>
                </msup>
                <mo>←</mo>
                <msup>
                  <mrow>
                    <mo fence="true">(</mo>
                    <msub>
                      <mi>u</mi>
                      <mn>1</mn>
                    </msub>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>u</mi>
                      <mi>L</mi>
                    </msub>
                    <mo separator="true">,</mo>
                    <mn>0</mn>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <mn>0</mn>
                    <mo fence="true">)</mo>
                  </mrow>
                  <mi>T</mi>
                </msup>
                <mo>∈</mo>
                <msup>
                  <mi mathvariant="double-struck">R</mi>
                  <mi>N</mi>
                </msup>
              </mrow>
              <annotation encoding="application/x-tex">u ^ { \prime } \leftarrow \left( u _ { 1 } , \ldots , u _ { L }
                , 0 , \ldots , 0 \right) ^ { T } \in \mathbb { R } ^ { N }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span
              class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.231231em;vertical-align:-0.25em;"></span><span
              class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span
                    class="mord mathit">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                          class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight"><span class="mord mathit mtight">L</span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord">0</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span
              class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span
                        style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                              style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span></span></span></span></span></li>
    <li data-line="370" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mover accent="true">
                  <mi>u</mi>
                  <mo>^</mo>
                </mover>
                <mo>←</mo>
                <mi>F</mi>
                <mi>F</mi>
                <msub>
                  <mi>T</mi>
                  <mi>N</mi>
                </msub>
                <mrow>
                  <mo fence="true">(</mo>
                  <msup>
                    <mi>u</mi>
                    <mo mathvariant="normal">′</mo>
                  </msup>
                  <mo fence="true">)</mo>
                </mrow>
              </mrow>
              <annotation encoding="application/x-tex">\hat { u } \leftarrow F F T _ { N } \left( u ^ { \prime }
                \right)</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
              class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">u</span></span></span><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;">^</span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span
              class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span
              class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter"
                style="top:0em;">(</span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span
                    class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
                class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></li>
    <li data-line="371" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msup>
                  <mi>v</mi>
                  <mo mathvariant="normal">′</mo>
                </msup>
                <mo>←</mo>
                <msup>
                  <mrow>
                    <mo fence="true">(</mo>
                    <msub>
                      <mi>v</mi>
                      <mn>1</mn>
                    </msub>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>v</mi>
                      <mi>K</mi>
                    </msub>
                    <mo separator="true">,</mo>
                    <mn>0</mn>
                    <mo separator="true">,</mo>
                    <mo>…</mo>
                    <mo separator="true">,</mo>
                    <mn>0</mn>
                    <mo fence="true">)</mo>
                  </mrow>
                  <mi>T</mi>
                </msup>
                <mo>∈</mo>
                <msup>
                  <mi mathvariant="double-struck">R</mi>
                  <mi>N</mi>
                </msup>
              </mrow>
              <annotation encoding="application/x-tex">v ^ { \prime } \leftarrow \left( v _ { 1 } , \ldots , v _ { K }
                , 0 , \ldots , 0 \right) ^ { T } \in \mathbb { R } ^ { N }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span
              class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.231231em;vertical-align:-0.25em;"></span><span
              class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span
                    class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                  class="mord mathit mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord">0</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span
              class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span
                        style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                              style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span></span></span></span></span></li>
    <li data-line="372" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mover accent="true">
                  <mi>v</mi>
                  <mo>^</mo>
                </mover>
                <mo>←</mo>
                <mi>F</mi>
                <mi>F</mi>
                <msub>
                  <mi>T</mi>
                  <mi>N</mi>
                </msub>
                <mrow>
                  <mo fence="true">(</mo>
                  <msup>
                    <mi>v</mi>
                    <mo mathvariant="normal">′</mo>
                  </msup>
                  <mo fence="true">)</mo>
                </mrow>
              </mrow>
              <annotation encoding="application/x-tex">\hat { v } \leftarrow F F T _ { N } \left( v ^ { \prime }
                \right)</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
              class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit"
                          style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;">^</span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span
              class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span
              class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter"
                style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span
                  class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span
                          style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
                class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></li>
    <li data-line="373" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msup>
                  <mi>g</mi>
                  <mo mathvariant="normal">′</mo>
                </msup>
                <mo>←</mo>
                <mi>I</mi>
                <mi>F</mi>
                <mi>F</mi>
                <msub>
                  <mi>T</mi>
                  <mi>N</mi>
                </msub>
                <mo>(</mo>
                <mover accent="true">
                  <mi>v</mi>
                  <mo>^</mo>
                </mover>
                <mo>⊙</mo>
                <mover accent="true">
                  <mi>u</mi>
                  <mo>^</mo>
                </mover>
                <mo>)</mo>
              </mrow>
              <annotation encoding="application/x-tex">g ^ { \prime } \leftarrow I F F T _ { N } ( \hat { v } \odot
                \hat { u } )</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span
              class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span
              class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathit"
                style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                    style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                        class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;">^</span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">u</span></span></span><span
                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;">^</span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></li>
    <li data-line="374" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>w</mi>
                <mo>←</mo>
                <mo>(</mo>
                <mn>1</mn>
                <mo separator="true">,</mo>
                <mo>…</mo>
                <mo separator="true">,</mo>
                <mi>L</mi>
                <mo separator="true">,</mo>
                <mi>L</mi>
                <mo separator="true">,</mo>
                <mi>L</mi>
                <mo separator="true">,</mo>
                <mi>L</mi>
                <mo separator="true">,</mo>
                <mi>L</mi>
                <mo separator="true">,</mo>
                <mo>…</mo>
                <mo separator="true">,</mo>
                <mn>1</mn>
                <mo>)</mo>
                <mo>∈</mo>
                <msup>
                  <mi mathvariant="double-struck">R</mi>
                  <mi>N</mi>
                </msup>
              </mrow>
              <annotation encoding="application/x-tex">w \leftarrow ( 1 , \ldots , L , L , L , L , L , \ldots , 1 ) \in
                \mathbb { R } ^ { N }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
              class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span
              class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathit">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathit">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathit">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathit">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathit">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span
                class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span
                    class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span></span></span></span></span></li>
    <li data-line="375" class="code-line"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi>g</mi>
                <mo>←</mo>
                <mi>σ</mi>
                <mrow>
                  <mo fence="true">(</mo>
                  <mi>w</mi>
                  <mo>⊙</mo>
                  <msup>
                    <mi>g</mi>
                    <mo mathvariant="normal">′</mo>
                  </msup>
                  <mo fence="true">)</mo>
                </mrow>
              </mrow>
              <annotation encoding="application/x-tex">g \leftarrow \sigma \left( w \odot g ^ { \prime } \right)</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span
              class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathit"
              style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span
                  class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span
                          style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
                class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></li>
  </ol>
  <hr>
  <p data-line="378" class="code-line">The computational complexity of this algorithm is <span class="katex"><span
        class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>O</mi>
              <mo>(</mo>
              <mi>N</mi>
              <mi>log</mi>
              <mo>⁡</mo>
              <mi>N</mi>
              <mo>)</mo>
            </mrow>
            <annotation encoding="application/x-tex">O ( N \log N )</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathit"
            style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>
    multiplications
    versus <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>O</mi>
              <mo>(</mo>
              <mi>L</mi>
              <mi>K</mi>
              <mo>)</mo>
            </mrow>
            <annotation encoding="application/x-tex">O ( L K )</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathit">L</span><span
            class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mclose">)</span></span></span></span>
    for naive direct approach. Basically this means that the worst
    case complexity of the diagonal averaging drops from <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>O</mi>
              <mrow>
                <mo fence="true">(</mo>
                <msup>
                  <mi>N</mi>
                  <mn>2</mn>
                </msup>
                <mo fence="true">)</mo>
              </mrow>
            </mrow>
            <annotation encoding="application/x-tex">O \left( N ^ { 2 } \right)</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span
            class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span
              class="mord"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span
                        style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span
              class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span>
    to <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>O</mi>
              <mo>(</mo>
              <mi>N</mi>
              <mi>log</mi>
              <mo>⁡</mo>
              <mi>N</mi>
              <mo>)</mo>
              <mi mathvariant="normal">.</mi>
            </mrow>
            <annotation encoding="application/x-tex">O ( N \log N ) .</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathit"
            style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
            class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></p>
  <pre><code data-line="382" class="code-line language-java"><div><span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Reconstructer</span> </span>{

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> FFTransformer dft;
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AverageFunction function;
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> isFourier;
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> rank;

  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> RealMatrix <span class="hljs-title">getComponent</span><span class="hljs-params">(<span class="hljs-keyword">final</span> SVD svd, <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> colNum)</span> </span>{
    <span class="hljs-keyword">final</span> Matrix uMatrix = svd.getU();
    <span class="hljs-keyword">final</span> Matrix vtMatrix = svd.getV();
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] sv = svd.getSingularValues();
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> m = uMatrix.nrows();
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> n = vtMatrix.nrows();
    Array2DRowRealMatrix matrix = <span class="hljs-keyword">new</span> Array2DRowRealMatrix(m, n);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++) {
      <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> eigenVectorValue = uMatrix.get(i, colNum);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j++) {
        <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> factorVectorValue = vtMatrix.get(j, colNum);
        matrix.setEntry(i, j, eigenVectorValue * factorVectorValue * sv[colNum]);
      }
    }
    <span class="hljs-keyword">return</span> matrix;
  }

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">double</span>[] wNormVector(<span class="hljs-keyword">int</span> nrows, <span class="hljs-keyword">int</span> ncols) {
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[nrows + ncols - <span class="hljs-number">1</span>];
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> length = res.length;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; res.length; i++) {
      <span class="hljs-keyword">if</span> (i &lt; (<span class="hljs-keyword">double</span>) nrows) {
        res[i] = <span class="hljs-number">1</span> / (i + <span class="hljs-number">1</span>d);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i &gt;= (res.length - (<span class="hljs-keyword">double</span>) nrows)) {
        res[i] = <span class="hljs-number">1</span> / (length - (<span class="hljs-keyword">double</span>) i);
      } <span class="hljs-keyword">else</span> {
        res[i] = <span class="hljs-number">1</span> / (<span class="hljs-keyword">double</span>) nrows;
      }
    }
    <span class="hljs-keyword">return</span> res;
  }

  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">paddedVector</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Matrix uMatrix, <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> j, <span class="hljs-keyword">double</span>[] holder)</span> </span>{
    Arrays.fill(holder, <span class="hljs-number">0</span>d);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; uMatrix.nrows(); i++) {
      holder[i] = uMatrix.get(i, j);
    }
  }

  Map&lt;Integer, <span class="hljs-keyword">double</span>[]&gt; getReconstructed(<span class="hljs-keyword">final</span> SVD svd) {
    <span class="hljs-keyword">switch</span> (function) {
      <span class="hljs-keyword">case</span> AVG:
        <span class="hljs-keyword">return</span> isFourier ? fftReconstructed(svd) : fullReconstruct(svd);
      <span class="hljs-keyword">case</span> MEDIAN:
        <span class="hljs-keyword">return</span> fullReconstruct(svd);
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">"Illegal average function!"</span>);
    }
  }

  <span class="hljs-keyword">private</span> Map&lt;Integer, <span class="hljs-keyword">double</span>[]&gt; fullReconstruct(<span class="hljs-keyword">final</span> <span class="hljs-meta">@NotNull</span> SVD svd) {
    <span class="hljs-keyword">final</span> Map&lt;Integer, <span class="hljs-keyword">double</span>[]&gt; reconstructed = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rank; i++) {
      <span class="hljs-keyword">final</span> RealMatrix component = getComponent(svd, i);
      reconstructed.put(i, SSAUtils.reconstructSeries(component, function));
    }
    <span class="hljs-keyword">return</span> Collections.unmodifiableMap(reconstructed);
  }

  <span class="hljs-keyword">private</span> Map&lt;Integer, <span class="hljs-keyword">double</span>[]&gt; fftReconstructed(<span class="hljs-keyword">final</span> <span class="hljs-meta">@NotNull</span> SVD svd) {
    <span class="hljs-keyword">final</span> Matrix uMatrix = svd.getU();
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> r = rank;
    <span class="hljs-keyword">final</span> Matrix vMatrix = svd.getV();
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> seriesSize = uMatrix.nrows() + vMatrix.nrows() - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">double</span>[][] reconstructed = <span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[r][seriesSize];

    <span class="hljs-keyword">double</span>[] w = wNormVector(uMatrix.nrows(), vMatrix.nrows());
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] singularValues = svd.getSingularValues();
    <span class="hljs-keyword">final</span> Map&lt;Integer, <span class="hljs-keyword">double</span>[]&gt; map = <span class="hljs-keyword">new</span> ConcurrentHashMap&lt;&gt;();
    IntStream.range(<span class="hljs-number">0</span>, r).parallel().forEach(i -&gt; {
      <span class="hljs-keyword">double</span>[] eFT = <span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[seriesSize];
      <span class="hljs-keyword">double</span>[] fFT = <span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[seriesSize];
      paddedVector(uMatrix, i, eFT);
      <span class="hljs-keyword">double</span>[] e = dft.fft(eFT);
      paddedVector(vMatrix, i, fFT);
      <span class="hljs-keyword">double</span>[] f = dft.fft(fFT);
      MatrixUtils.wiseMultiplication(f, e);
      <span class="hljs-keyword">double</span>[] g = dft.ifft(f);
      <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> sigma = singularValues[i];
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; seriesSize; k++) {
        reconstructed[i][k] = (w[k] * g[k]) * sigma;
      }
      map.put(i, reconstructed[i]);
    });
    <span class="hljs-keyword">return</span> Collections.unmodifiableMap(map);
  }
}
</div></code></pre>
  <h4 id="grouping-1" data-line="480" class="code-line">Grouping</h4>
  <p data-line="481" class="code-line">This implementation allows to control grouping of reconstructed series manually
    or using w-correlation matrix.</p>
  <h4 id="form-proximity-matrix-1" data-line="483" class="code-line">Form proximity matrix</h4>
  <p data-line="485" class="code-line">Let <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mover accent="true">
                  <mi>X</mi>
                  <mo stretchy="true">~</mo>
                </mover>
                <mi>j</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">\widetilde { X } _ { j }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-0.286108em;"></span><span
            class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                    style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                        class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span></span></span><span
                      class="svg-align" style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.6833299999999998em;"><span
                        class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em'
                          viewBox='0 0 600 260' preserveAspectRatio='none'>
                          <path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z' /></svg></span></span></span></span></span></span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span
                      style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                            style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>
    be the elementary reconstructed components produced by the elementary
    grouping <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>I</mi>
                <mi>j</mi>
              </msub>
              <mo>=</mo>
              <mo>{</mo>
              <mi>j</mi>
              <mo>}</mo>
              <mi mathvariant="normal">.</mi>
            </mrow>
            <annotation encoding="application/x-tex">I _ { j } = \{ j \} .</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                            class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mopen">{</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">}</span><span
            class="mord">.</span></span></span></span> Then the matrix of <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msubsup>
                <mi>ρ</mi>
                <mrow>
                  <mi>i</mi>
                  <mi>j</mi>
                </mrow>
                <mrow>
                  <mo>(</mo>
                  <mi mathvariant="bold">w</mi>
                  <mo>)</mo>
                </mrow>
              </msubsup>
              <mo>=</mo>
              <msub>
                <mi>ρ</mi>
                <mi mathvariant="bold">w</mi>
              </msub>
              <mrow>
                <mo fence="true">(</mo>
                <msub>
                  <mover accent="true">
                    <mi mathvariant="double-struck">X</mi>
                    <mo stretchy="true">~</mo>
                  </mover>
                  <mi>i</mi>
                </msub>
                <mo separator="true">,</mo>
                <msub>
                  <mover accent="true">
                    <mi>X</mi>
                    <mo stretchy="true">~</mo>
                  </mover>
                  <mi>j</mi>
                </msub>
                <mo fence="true">)</mo>
              </mrow>
            </mrow>
            <annotation encoding="application/x-tex">\rho _ { i j } ^ { ( \mathbf { w } ) } = \rho _ { \mathbf { w } }
              \left( \widetilde { \mathbb { X } } _ { i } , \widetilde { X } _ { j } \right)</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-0.4129719999999999em;"></span><span
            class="mord"><span class="mord mathit">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight"
                            style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathbf mtight"
                              style="margin-right:0.01597em;">w</span></span><span class="mclose mtight">)</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4129719999999999em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span
            class="mord"><span class="mord mathit">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">w</span></span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter"
              style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord accent"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94889em;"><span style="top:-3em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">X</span></span></span></span><span
                        class="svg-align" style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.68889em;"><span
                          class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%'
                            height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'>
                            <path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z' /></svg></span></span></span></span></span></span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                        style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                      style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                          class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span></span></span><span
                        class="svg-align" style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.6833299999999998em;"><span
                          class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%'
                            height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'>
                            <path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z' /></svg></span></span></span></span></span></span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span
                        style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                              style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span
              class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span>
    is called w-correlation
    matrix.</p>
  <p data-line="489" class="code-line">The norm <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="normal">∥</mi>
              <mo>⋅</mo>
              <msub>
                <mi mathvariant="normal">∥</mi>
                <mi mathvariant="bold">w</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">\| \cdot \| _ { \mathbf { w } }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mord">∥</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
            style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span
                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span
                              class="mord mathbf mtight" style="margin-right:0.01597em;">w</span></span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    is called the weighted norm and serves as a measure of
    contribution of the components in the decomposition <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mo>(</mo>
              <mn>1.5</mn>
              <mo>)</mo>
              <mo>:</mo>
            </mrow>
            <annotation encoding="application/x-tex">( 1.5 ) :</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
            class="mopen">(</span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span
            class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span></span></span></span>
    the contribution of <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mover accent="true">
                  <mi>X</mi>
                  <mo stretchy="true">~</mo>
                </mover>
                <mi>k</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">\widetilde { X } _ { k }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.09333em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                    style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                        class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span></span></span><span
                      class="svg-align" style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.6833299999999998em;"><span
                        class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em'
                          viewBox='0 0 600 260' preserveAspectRatio='none'>
                          <path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z' /></svg></span></span></span></span></span></span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                      style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                            style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    is defined as <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msubsup>
                <mrow>
                  <mo fence="true">∥</mo>
                  <msub>
                    <mi mathvariant="double-struck">X</mi>
                    <mi>k</mi>
                  </msub>
                  <mo fence="true">∥</mo>
                </mrow>
                <mi mathvariant="bold">w</mi>
                <mn>2</mn>
              </msubsup>
              <mi mathvariant="normal">/</mi>
              <mi mathvariant="normal">∥</mi>
              <mi mathvariant="double-struck">X</mi>
              <msubsup>
                <mi mathvariant="normal">∥</mi>
                <mi mathvariant="bold">w</mi>
                <mn>2</mn>
              </msubsup>
            </mrow>
            <annotation encoding="application/x-tex">\left\| \mathbb { X } _ { k } \right\| _ { \mathbf { w } } ^ { 2 }
              / \| \mathbb { X } \| _ { \mathbf { w } } ^ { 2 }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.253708em;vertical-align:-0.29969999999999997em;"></span><span
            class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">∥</span><span class="mord"><span
                  class="mord"><span class="mord mathbb">X</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                class="mclose delimcenter" style="top:0em;">∥</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.4003em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">w</span></span></span></span></span><span
                      style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29969999999999997em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">/</span><span class="mord">∥</span><span
            class="mord"><span class="mord mathbb">X</span></span><span class="mord"><span class="mord">∥</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span
                      style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span
                              class="mord mathbf mtight" style="margin-right:0.01597em;">w</span></span></span></span></span><span
                      style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></p>
  <p data-line="493" class="code-line">If the weighted correlation between a pair of elementary components is large,
    then this suggests that these two components are highly correlated and should
    perhaps be included into the same group.</p>
  <pre><code data-line="497" class="code-line language-java"><div><span class="hljs-meta">@Slf</span>4j
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProximityMatrixEvaluator</span> </span>{

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;<span class="hljs-keyword">double</span>[]&gt; reconstructed;
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] frobeniusNorms;
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> wLen;

  ProximityMatrixEvaluator(<span class="hljs-keyword">final</span> List&lt;<span class="hljs-keyword">double</span>[]&gt; reconstructed, <span class="hljs-keyword">int</span> wLen) {
    <span class="hljs-comment">// Cache Frobenius norms of matrix</span>
    <span class="hljs-keyword">this</span>.reconstructed = reconstructed;
    <span class="hljs-keyword">this</span>.frobeniusNorms = <span class="hljs-keyword">this</span>.reconstructed.stream()
        .mapToDouble(r -&gt; Math.sqrt(weightedInnerProduct(r, r, wLen)))
        .toArray();
    <span class="hljs-keyword">this</span>.wLen = wLen;
  }


  <span class="hljs-keyword">double</span>[][] proximityMatrix() {
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> rank = reconstructed.size();
    <span class="hljs-keyword">double</span>[][] result = <span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[rank][rank];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; result.length; i++) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i; j &lt; result.length; j++) {
        <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> wCov = wCorrelation(i, j);
        <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> v = Math.abs((<span class="hljs-number">1</span> - wCov));
        result[i][j] = v;
        result[j][i] = v;
      }
    }
    <span class="hljs-keyword">return</span> result;
  }


  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> <span class="hljs-title">wCorrelation</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> aIndex, <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> bIndex)</span> </span>{
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] a = reconstructed.get(aIndex);
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] b = reconstructed.get(bIndex);
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> d = frobeniusNorms[aIndex] * frobeniusNorms[bIndex];
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> v = weightedInnerProduct(a, b, wLen) / d;
    <span class="hljs-keyword">if</span> (v &gt; <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">if</span> (v &lt; -<span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">return</span> v;
  }

}
</div></code></pre>
  <h5 id="clustering-of-the-reconstrcted-series-1" data-line="547" class="code-line">Clustering of the reconstrcted
    series</h5>
  <pre><code data-line="549" class="code-line language-java"><div><span class="hljs-keyword">double</span>[][] p = getProximityMatrix();
log.debug(<span class="hljs-string">"Grouping started"</span>);

<span class="hljs-keyword">final</span> HierarchicalClustering hac = <span class="hljs-keyword">new</span> HierarchicalClustering(<span class="hljs-keyword">new</span> CompleteLinkage(p));
<span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> pSize = groupingConfiguration.getGroupsCount() + <span class="hljs-number">1</span>;
<span class="hljs-keyword">if</span> (p.length &lt; pSize) {
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(String.format(
      <span class="hljs-string">"Too many elements %d for clustering with size %d. Try to decrease group-count param"</span>,
      p.length, pSize));
}
<span class="hljs-keyword">int</span>[] membership = hac.partition(pSize);
log.debug(<span class="hljs-string">"Grouping finished"</span>);
log.debug(<span class="hljs-string">"Forecast starts"</span>);
<span class="hljs-keyword">final</span> Map&lt;Integer, List&lt;Integer&gt;&gt; partition = IntStream.range(<span class="hljs-number">0</span>, svd.getRank())
    .boxed()
    .collect(Collectors.groupingBy(i -&gt; membership[i]));
</div></code></pre>
  <div style="position:relative;padding-top:56.25%;overflow: hidden;">
    <iframe style="position:absolute;top:0;left:0;width:100%;height:100%;margin: auto;" src="https://jsfiddle.net/shmagrinskiy/wL4652jq/18/embedded/result,js/"
      allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
  </div>
  <h4 id="forecasting-1" data-line="572" class="code-line">Forecasting</h4>
  <p data-line="574" class="code-line">Currenty Java implementation has only Recurent Algorithm for forecast.</p>
  <p data-line="576" class="code-line">For a chosen window length <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>L</mi>
              <mo separator="true">,</mo>
            </mrow>
            <annotation encoding="application/x-tex">L ,</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
            class="mord mathit">L</span><span class="mpunct">,</span></span></span></span> the signal subspace <span
      class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>S</mi>
              <mo>∈</mo>
              <msup>
                <mi>R</mi>
                <mi>L</mi>
              </msup>
            </mrow>
            <annotation encoding="application/x-tex">S \in R ^ { L }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span
            class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span
              class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span
                  class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">L</span></span></span></span></span></span></span></span></span></span></span></span>
    and therefore the
    min-norm LRR has order <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi>L</mi>
              <mo>−</mo>
              <mn>1.</mn>
            </mrow>
            <annotation encoding="application/x-tex">L - 1 .</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span
            class="mord mathit">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
          class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span
            class="mord">.</span></span></span></span> For each column vector <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>P</mi>
                <mi>i</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">P _ { i }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                            class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    of <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi mathvariant="bold">P</mi>
                <mi>r</mi>
              </msub>
              <mo separator="true">,</mo>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf { P } _ { r } ,</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span
            class="mord"><span class="mord"><span class="mord mathbf">P</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span></span></span></span> denote <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>π</mi>
                <mi>i</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">\pi _ { i }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.03588em;">π</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                            class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    the last
    coordinate of <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>P</mi>
                <mi>i</mi>
              </msub>
              <mo separator="true">,</mo>
              <msub>
                <mi>P</mi>
                <mi>i</mi>
              </msub>
              <mo>∈</mo>
              <msup>
                <mi>R</mi>
                <mrow>
                  <mi>L</mi>
                  <mo>−</mo>
                  <mn>1</mn>
                </mrow>
              </msup>
            </mrow>
            <annotation encoding="application/x-tex">P _ { i } , P _ { i } \in R ^ { L - 1 }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                            class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
              class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span
                class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span
                      style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">L</span><span
                            class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>
    the vector <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>P</mi>
                <mi>i</mi>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">P _ { i }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                      style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut"
                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                            class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
    with the last coordinate removed, and
    <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msup>
                <mi>v</mi>
                <mn>2</mn>
              </msup>
              <mo>=</mo>
              <msubsup>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mi>r</mi>
              </msubsup>
              <msubsup>
                <mi>π</mi>
                <mi>i</mi>
                <mn>2</mn>
              </msubsup>
              <mi mathvariant="normal">.</mi>
            </mrow>
            <annotation encoding="application/x-tex">v ^ { 2 } = \sum _ { i = 1 } ^ { r } \pi _ { i } ^ { 2 } .</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span
                class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span
                      style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.113818em;vertical-align:-0.29971000000000003em;"></span><span
            class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span
                      style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span
                            class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span
                      style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                            style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit"
              style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:-0.03588em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span
            class="mord">.</span></span></span></span> Then the elements of the vector</p>
  <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi mathvariant="script">R</mi>
                <mo>=</mo>
                <mrow>
                  <mo fence="true">(</mo>
                  <msub>
                    <mi>a</mi>
                    <mrow>
                      <mi>L</mi>
                      <mo>−</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                  <mo separator="true">,</mo>
                  <mo>…</mo>
                  <mo separator="true">,</mo>
                  <msub>
                    <mi>a</mi>
                    <mn>1</mn>
                  </msub>
                  <mo fence="true">)</mo>
                </mrow>
                <mo>=</mo>
                <mfrac>
                  <mn>1</mn>
                  <mrow>
                    <mn>1</mn>
                    <mo>−</mo>
                    <msup>
                      <mi>v</mi>
                      <mn>2</mn>
                    </msup>
                  </mrow>
                </mfrac>
                <munderover>
                  <mo>∑</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mi>r</mi>
                </munderover>
                <msub>
                  <mi>π</mi>
                  <mi>i</mi>
                </msub>
                <msub>
                  <munder accentunder="true">
                    <mi>P</mi>
                    <mo stretchy="true">‾</mo>
                  </munder>
                  <mi>i</mi>
                </msub>
              </mrow>
              <annotation encoding="application/x-tex">
                \mathcal { R } = \left( a _ { L - 1 } , \ldots , a _ { 1 } \right) = \frac { 1 } { 1 - v ^ { 2 } } \sum
                _ { i = 1 } ^ { r } \pi _ { i } \underline { P } _ { i }
              </annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord"><span class="mord mathcal">R</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span
                class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathit">a</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mathit mtight">L</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
                class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                      class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span
                          class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span
                                      style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span
                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span
                      style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span
                            class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span
                      style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span
                      style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                            style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit"
                style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                      class="vlist" style="height:0.68333em;"><span style="top:-2.84em;"><span class="pstrut" style="height:3em;"></span><span
                          class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20000000000000007em;"><span></span></span></span></span></span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2119639999999999em;"><span
                        style="top:-2.4503em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24970000000000006em;"><span></span></span></span></span></span></span></span></span></span></span></p>
  <p data-line="585" class="code-line">provide the coefficients of the min-norm governing LRR: <span class="katex"><span
        class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi>s</mi>
                <mi>n</mi>
              </msub>
              <mo>=</mo>
              <msubsup>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mrow>
                  <mi>L</mi>
                  <mo>−</mo>
                  <mn>1</mn>
                </mrow>
              </msubsup>
              <msub>
                <mi>a</mi>
                <mi>i</mi>
              </msub>
              <msub>
                <mi>s</mi>
                <mrow>
                  <mi>n</mi>
                  <mo>−</mo>
                  <mi>i</mi>
                </mrow>
              </msub>
            </mrow>
            <annotation encoding="application/x-tex">s _ { n } = \sum _ { i = 1 } ^ { L - 1 } a _ { i } s _ { n - i }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord mathit">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-0.29971000000000003em;"></span><span
            class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span
                      style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span
                            class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span
                      style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">L</span><span
                            class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">a</span><span
              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mord"><span class="mord mathit">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">−</span><span
                            class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span
                  class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></p>
  <h5 id="estimation-of-the-signal-lrr-1" data-line="587" class="code-line">Estimation of the signal LRR</h5>
  <p data-line="589" class="code-line"><strong>Input</strong>: Matrix <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <msub>
                <mi mathvariant="bold">P</mi>
                <mi>r</mi>
              </msub>
              <mo>∈</mo>
              <msup>
                <mi mathvariant="normal">R</mi>
                <mrow>
                  <mi>L</mi>
                  <mo>×</mo>
                  <mi>r</mi>
                </mrow>
              </msup>
            </mrow>
            <annotation encoding="application/x-tex">\mathbf { P } _ { r } \in \mathrm { R } ^ { L \times r }</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83611em;vertical-align:-0.15em;"></span><span
            class="mord"><span class="mord"><span class="mord mathbf">P</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
            class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace"
            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span
            class="mord"><span class="mord"><span class="mord mathrm">R</span></span><span class="msupsub"><span class="vlist-t"><span
                  class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                        class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                          class="mord mtight"><span class="mord mathit mtight">L</span><span class="mbin mtight">×</span><span
                            class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span></span>
    consisting of orthonormal column vectors, which form a basis of the
    estimated signal subspace.</p>
  <p data-line="592" class="code-line"><strong>Output</strong>: Coefficients <span class="katex"><span class="katex-mathml"><math>
          <semantics>
            <mrow>
              <mi mathvariant="script">R</mi>
              <mo>=</mo>
              <mrow>
                <mo fence="true">(</mo>
                <msub>
                  <mi>a</mi>
                  <mrow>
                    <mi>L</mi>
                    <mo>−</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo separator="true">,</mo>
                <mo>…</mo>
                <mo separator="true">,</mo>
                <msub>
                  <mi>a</mi>
                  <mn>1</mn>
                </msub>
                <mo fence="true">)</mo>
              </mrow>
            </mrow>
            <annotation encoding="application/x-tex">\mathcal { R } = \left( a _ { L - 1 } , \ldots , a _ { 1 } \right)</annotation>
          </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
            class="mord"><span class="mord mathcal">R</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
          class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span
              class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathit">a</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span
                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mathit mtight">L</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span> of the corresponding
    LRR.</p>
  <hr>
  <ol>
    <li data-line="596" class="code-line">For each column vector <span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msub>
                  <mi>P</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
              <annotation encoding="application/x-tex">P _ { i }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
              class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
      of <span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msub>
                  <mi mathvariant="bold">P</mi>
                  <mi>r</mi>
                </msub>
                <mo separator="true">,</mo>
              </mrow>
              <annotation encoding="application/x-tex">\mathbf { P } _ { r } ,</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span
              class="mord"><span class="mord"><span class="mord mathbf">P</span></span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                        style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                              style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mpunct">,</span></span></span></span> calculate <span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msub>
                  <mi>π</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
              <annotation encoding="application/x-tex">\pi _ { i }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span
              class="mord"><span class="mord mathit" style="margin-right:0.03588em;">π</span><span class="msupsub"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
      and <span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msub>
                  <munder accentunder="true">
                    <mi>P</mi>
                    <mo stretchy="true">‾</mo>
                  </munder>
                  <mi>i</mi>
                </msub>
                <mo separator="true">,</mo>
                <msup>
                  <mi>v</mi>
                  <mn>2</mn>
                </msup>
                <mo>=</mo>
                <msubsup>
                  <mo>∑</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mi>r</mi>
                </msubsup>
                <msubsup>
                  <mi>π</mi>
                  <mi>i</mi>
                  <mn>2</mn>
                </msubsup>
                <mi mathvariant="normal">.</mi>
              </mrow>
              <annotation encoding="application/x-tex">\underline { P } _ { i } , v ^ { 2 } = \sum _ { i = 1 } ^ { r }
                \pi _ { i } ^ { 2 } .</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.063808em;vertical-align:-0.24970000000000006em;"></span><span
              class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                      class="vlist" style="height:0.68333em;"><span style="top:-2.84em;"><span class="pstrut" style="height:3em;"></span><span
                          class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20000000000000007em;"><span></span></span></span></span></span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2119639999999999em;"><span
                        style="top:-2.4503em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24970000000000006em;"><span></span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span
                        style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.113818em;vertical-align:-0.29971000000000003em;"></span><span
              class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span
                        style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span
                              class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span
                        style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                              style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit"
                style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:-0.03588em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span><span
                        style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span
              class="mord">.</span></span></span></span> If <span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <msup>
                  <mi>v</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
              <annotation encoding="application/x-tex">v ^ { 2 }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span
              class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span
                        style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>
      is equal to <span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mn>1</mn>
                <mo separator="true">,</mo>
              </mrow>
              <annotation encoding="application/x-tex">1 ,</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span
              class="mord">1</span><span class="mpunct">,</span></span></span></span> then STOP with the error message
      &quot;Verticality coefficient equals <span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mn>1.</mn>
                <mi mathvariant="normal">&quot;</mi>
              </mrow>
              <annotation encoding="application/x-tex">1 . &quot;</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
              class="mord">1</span><span class="mord">.</span><span class="mord">&quot;</span></span></span></span></li>
    <li data-line="597" class="code-line">Compute <span class="katex"><span class="katex-mathml"><math>
            <semantics>
              <mrow>
                <mi mathvariant="script">R</mi>
                <mo>=</mo>
                <mfrac>
                  <mn>1</mn>
                  <mrow>
                    <mn>1</mn>
                    <mo>−</mo>
                    <msup>
                      <mi>v</mi>
                      <mn>2</mn>
                    </msup>
                  </mrow>
                </mfrac>
                <msubsup>
                  <mo>∑</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mi>r</mi>
                </msubsup>
                <msub>
                  <mi>π</mi>
                  <mi>i</mi>
                </msub>
                <msub>
                  <munder accentunder="true">
                    <mi>P</mi>
                    <mo stretchy="true">‾</mo>
                  </munder>
                  <mi>i</mi>
                </msub>
              </mrow>
              <annotation encoding="application/x-tex">\mathcal { R } = \frac { 1 } { 1 - v ^ { 2 } } \sum _ { i = 1 }
                ^ { r } \pi _ { i } \underline { P } _ { i }</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
              class="mord"><span class="mord mathcal">R</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span
              class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span
                          class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span
                              class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut"
                          style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span
                        style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span
                              class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span
                        style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight"
                              style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit"
                style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                      class="vlist" style="height:0.68333em;"><span style="top:-2.84em;"><span class="pstrut" style="height:3em;"></span><span
                          class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20000000000000007em;"><span></span></span></span></span></span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2119639999999999em;"><span
                        style="top:-2.4503em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24970000000000006em;"><span></span></span></span></span></span></span></span></span></span></li>
  </ol>
  <hr>
  <pre><code data-line="601" class="code-line language-java"><div>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">double</span>[] lrr(Matrix uMatrix, List&lt;Integer&gt; idx) {
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> rowDimension = uMatrix.nrows();
    <span class="hljs-keyword">final</span> RealVector lastRow = MatrixUtils.getRealRow(uMatrix, (rowDimension - <span class="hljs-number">1</span>));
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] pis = lastRow.toArray();

    <span class="hljs-keyword">double</span> vSquared = idx.stream().mapToDouble(i -&gt; pis[i] * pis[i]).sum();
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> mul = <span class="hljs-number">1.0</span>d / (<span class="hljs-number">1.0</span>d - vSquared);
    <span class="hljs-keyword">return</span> idx.stream()
        .map(i -&gt; MatrixUtils.getRealColumn(uMatrix, i).getSubVector(<span class="hljs-number">0</span>, rowDimension - <span class="hljs-number">1</span>)
            .mapMultiply(pis[i]))
        .reduce(<span class="hljs-keyword">null</span>, (acc, term) -&gt; acc == <span class="hljs-keyword">null</span> ? term : acc.add(term))
        .mapMultiply(mul)
        .toArray();
  }


<span class="hljs-function"><span class="hljs-keyword">static</span> ForecastGroup <span class="hljs-title">forecastGroup</span><span class="hljs-params">(<span class="hljs-keyword">final</span> SvdHolder svd, EigenGroup eigenGroup, <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> id,
      ForecastConfiguration forecastConfiguration)</span> </span>{
    List&lt;Integer&gt; idx = eigenGroup.getIds();
    <span class="hljs-keyword">if</span> (log.isDebugEnabled()) {
      log.debug(<span class="hljs-string">"Creating forecast for group {} using orthonormal vectors with ids: {}"</span>,
          id, idx.stream().map(i -&gt; i + <span class="hljs-number">1</span>).collect(toList()));
    }
    <span class="hljs-keyword">final</span> Matrix uMatrix = svd.getuMatrix();
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] reconstructed = idx.stream().map(svd::getReconstructed)
        .map(ArrayRealVector::<span class="hljs-keyword">new</span>)
        .reduce(<span class="hljs-keyword">new</span> ArrayRealVector(svd.getSeriesSize()),
            ArrayRealVector::add).toArray();
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> seriesSize = reconstructed.length;
    <span class="hljs-keyword">final</span> ForecastMode mode = forecastConfiguration.getForecastMode();
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> rank = svd.getRank();
    <span class="hljs-keyword">if</span> (mode == ForecastMode.RECONSTRUCTED) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ForecastGroup(id, reconstructed, <span class="hljs-keyword">null</span>, idx, rank, eigenGroup.getMode());
    }
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] lrr = SSAUtils.lrr(uMatrix, idx);
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>[] forecast = <span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[forecastConfiguration.getForecastLength()];
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> wLen = forecastConfiguration.getWindowLength() &lt;= <span class="hljs-number">0</span> ? seriesSize / <span class="hljs-number">2</span>
        : forecastConfiguration.getWindowLength();
    Deque&lt;Double&gt; previousVector = deque(reconstructed, seriesSize - wLen + <span class="hljs-number">1</span>, seriesSize);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= forecastConfiguration.getForecastLength(); i++) {
      <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> nextValue = dotProduct(previousVector, lrr);
      previousVector.addLast(nextValue);
      previousVector.removeFirst();
      forecast[i - <span class="hljs-number">1</span>] = nextValue;
    }
    <span class="hljs-keyword">if</span> (log.isDebugEnabled()) {
      log.debug(<span class="hljs-string">"Forecast by group {} {}"</span>, id, Arrays.toString(forecast));
    }
    <span class="hljs-keyword">if</span> (ForecastMode.FORECAST == mode) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ForecastGroup(id, <span class="hljs-keyword">null</span>, forecast, idx, rank, eigenGroup.getMode());
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ForecastGroup(id, reconstructed, forecast, idx, rank, eigenGroup.getMode());
}

</div></code></pre>
  <div style="position:relative;padding-top:56.25%;overflow: hidden;">
    <iframe style="position:absolute;top:0;left:0;width:100%;height:100%;margin: auto;" src="https://jsfiddle.net/shmagrinskiy/yruoqtks/embedded/result,js/"
      allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
  </div>
  <h2 id="usages-1" data-line="663" class="code-line">Usages</h2>
  <p data-line="665" class="code-line">This software is applied as maven package. Add dependency to your build system
    file according to <a href="https://jitpack.io/#unrealwork/ssa-java#how-to">JitPack instruction</a>.</p>
  <pre><code data-line="667" class="code-line language-xml"><div>    ...
    <span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>jitpack.io<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://jitpack.io<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.unrealwork<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>ssa-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.19<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependecies</span>&gt;</span>
</div></code></pre>
  <h3 id="sample-1" data-line="685" class="code-line">Sample</h3>
  <pre><code data-line="687" class="code-line language-java"><div><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExtendedGroupingSample</span> </span>{

    <span class="hljs-comment">/**
     * Entry point for sample program.
     *
     * <span class="hljs-doctag">@param</span> args no args requested.
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        DataSet ds = Datasets.file(<span class="hljs-string">"wine.in"</span>);
        <span class="hljs-keyword">double</span>[] series = ds.getValues();
        <span class="hljs-keyword">final</span> AutoGroupingConfiguration autoGroupingConfiguration =
                <span class="hljs-keyword">new</span> AutoGroupingConfiguration(<span class="hljs-number">3</span>, <span class="hljs-keyword">false</span>);
        <span class="hljs-keyword">final</span> ForecastConfiguration configuration = ForecastConfiguration
                .builder(ForecastMode.FULL, <span class="hljs-number">84</span>, <span class="hljs-number">12</span>)
                .autoGroupingConfiguration(autoGroupingConfiguration)
                .auto(<span class="hljs-keyword">true</span>)
                .groups(Collections.singletonList(<span class="hljs-keyword">new</span> HashSet&lt;&gt;(Collections.singletonList(<span class="hljs-number">1</span>))))
                .build();
        <span class="hljs-keyword">final</span> Map&lt;Integer, ForecastGroup&gt; result = SSADivination.with(series, configuration)
                .forecast();
        <span class="hljs-keyword">final</span> XYChart chart = forecastChart(ds, result);
        <span class="hljs-keyword">final</span> SwingWrapper wrapper = <span class="hljs-keyword">new</span> SwingWrapper&lt;&gt;(chart);
        wrapper.displayChart();
    }
}
</div></code></pre>
  <h2 id="benchmarks-1" data-line="715" class="code-line">Benchmarks</h2>
  <h3 id="difference-between-native-approach-and-fast-multiplication-version-1" data-line="717" class="code-line">Difference
    between native approach and fast-multiplication version</h3>
  <p data-line="719" class="code-line">Simple JMH Bencmarking result, window length set to half of series length.</p>
  <table>
    <thead>
      <tr>
        <th>Length</th>
        <th>FULL</th>
        <th>TRUNCATED</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1000</td>
        <td>2514 ms</td>
        <td>500 ms</td>
      </tr>
      <tr>
        <td>2000</td>
        <td>9672 ms</td>
        <td>800 ms</td>
      </tr>
      <tr>
        <td>4000</td>
        <td>66157 ms</td>
        <td>1200 ms</td>
      </tr>
    </tbody>
  </table>
  <h2 id="sources-1" data-line="727" class="code-line">Sources</h2>
  <ol>
    <li data-line="729" class="code-line"><a href="https://www.springer.com/gp/book/9783662573785">Singular Spectrum
        Analysis with R</a></li>
    <li data-line="730" class="code-line"><a href="https://arxiv.org/pdf/0911.4498.pdf">Computation and Space-Efficient
        Implementation of SSA</a></li>
    <li data-line="731" class="code-line"><a href="https://github.com/asl/rssa">Rssa Github page</a></li>
  </ol>

</body>

</html>